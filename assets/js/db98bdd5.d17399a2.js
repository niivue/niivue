"use strict";(self.webpackChunk_niivue_docs=self.webpackChunk_niivue_docs||[]).push([[245],{106:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>j,contentTitle:()=>y,default:()=>b,frontMatter:()=>x,metadata:()=>a,toc:()=>f});const a=JSON.parse('{"id":"thresholding","title":"Statistical Thresholding","description":"Statistical thresholding is a crucial technique in neuroimaging and other medical imaging disciplines, allowing researchers to visualize only statistically significant regions in their data. Niivue provides powerful and flexible thresholding capabilities that enable users to display both positive and negative statistical values, customize thresholds, and adjust visualization options around these thresholds.","source":"@site/docs/thresholding.mdx","sourceDirName":".","slug":"/thresholding","permalink":"/docs/thresholding","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"title":"Statistical Thresholding","sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Synchronizing Multiple Views","permalink":"/docs/syncing"},"next":{"title":"Drawing and Segmentation","permalink":"/docs/drawing"}}');var t=i(1085),l=i(1184),s=i(6190),r=i(4041);const o="https://niivue.com/demos",c=[{url:`${o}/images/fslmean.nii.gz`,colormap:"gray",opacity:1,visible:!0},{url:`${o}/images/fslt.nii.gz`,colormap:"warm",colormapNegative:"winter",cal_min:.3,cal_max:.6,cal_minNeg:-.6,cal_maxNeg:-.3,visible:!0}],d={isColorbar:!0,backColor:[1,1,1,1],show3Dcrosshair:!0,multiplanarLayout:2},u=e=>{let{nvOpts:n={}}=e;const i=(0,r.useRef)(null),a=(0,r.useRef)(null),[l,o]=(0,r.useState)(3),[u,h]=(0,r.useState)(6),[p,m]=(0,r.useState)(3),[v,g]=(0,r.useState)(6),[x,y]=(0,r.useState)(1),[j,f]=(0,r.useState)(0),[w,b]=(0,r.useState)(!0),[C,N]=(0,r.useState)(!1),[V,S]=(0,r.useState)(""),k={...d,...n};(0,r.useEffect)((()=>((async()=>{if(!a.current&&i.current){console.log("Initializing Niivue...");const n=new s.FM({...k,onLocationChange:e=>S(e.string)});a.current=n,await n.attachToCanvas(i.current),console.log("Niivue attached to canvas.");try{await n.loadVolumes(c),console.log("Volumes loaded in Niivue."),n.volumes[0].colorbarVisible=!1,F(),n.setInterpolation(!C),n.overlayOutlineWidth=.25*x,n.updateGLVolume()}catch(e){console.error("Error loading volumes:",e)}}})(),()=>{console.log("Cleaning up Niivue instance..."),a.current=null})),[]);const F=()=>{if(!a.current||!a.current.volumes||a.current.volumes.length<2)return;const e=a.current.volumes[1];e.cal_min=.1*l,e.cal_max=.1*u,e.cal_minNeg=.1*-v,e.cal_maxNeg=.1*-p,a.current.updateGLVolume()};(0,r.useEffect)((()=>{a.current&&a.current.volumes&&a.current.volumes.length>1&&(a.current.volumes[1].cal_min=.1*l,a.current.updateGLVolume())}),[l]),(0,r.useEffect)((()=>{a.current&&a.current.volumes&&a.current.volumes.length>1&&(a.current.volumes[1].cal_max=.1*u,a.current.updateGLVolume())}),[u]),(0,r.useEffect)((()=>{a.current&&a.current.volumes&&a.current.volumes.length>1&&(a.current.volumes[1].cal_maxNeg=.1*-p,a.current.updateGLVolume())}),[p]),(0,r.useEffect)((()=>{a.current&&a.current.volumes&&a.current.volumes.length>1&&(a.current.volumes[1].cal_minNeg=.1*-v,a.current.updateGLVolume())}),[v]),(0,r.useEffect)((()=>{a.current&&(a.current.overlayOutlineWidth=.25*x,a.current.updateGLVolume())}),[x]),(0,r.useEffect)((()=>{a.current&&a.current.volumes&&a.current.volumes.length>1&&(a.current.volumes[1].colormapType=j,a.current.updateGLVolume())}),[j]),(0,r.useEffect)((()=>{a.current&&a.current.volumes&&a.current.volumes.length>1&&(w?a.current.setColormapNegative(a.current.volumes[1].id,"winter"):a.current.setColormapNegative(a.current.volumes[1].id,""),a.current.drawScene())}),[w]),(0,r.useEffect)((()=>{a.current&&a.current.setInterpolation(!C)}),[C]);return(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"15px",padding:"10px",border:"1px solid #ccc",borderRadius:"8px",marginBottom:"15px"},children:[(0,t.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:"15px",alignItems:"center",width:"100%"},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[(0,t.jsx)("label",{htmlFor:"posThreshold",children:"+Thresh:"}),(0,t.jsx)("input",{type:"range",id:"posThreshold",min:"1",max:"50",value:l,onChange:e=>o(parseInt(e.target.value))}),(0,t.jsx)("span",{children:(.1*l).toFixed(1)})]}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[(0,t.jsx)("label",{htmlFor:"posMax",children:"+Max:"}),(0,t.jsx)("input",{type:"range",id:"posMax",min:"51",max:"150",value:u,onChange:e=>h(parseInt(e.target.value))}),(0,t.jsx)("span",{children:(.1*u).toFixed(1)})]}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[(0,t.jsx)("label",{htmlFor:"negThreshold",children:"-Thresh:"}),(0,t.jsx)("input",{type:"range",id:"negThreshold",min:"1",max:"50",value:p,onChange:e=>m(parseInt(e.target.value))}),(0,t.jsx)("span",{children:(.1*p).toFixed(1)})]}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[(0,t.jsx)("label",{htmlFor:"negMax",children:"-Max:"}),(0,t.jsx)("input",{type:"range",id:"negMax",min:"51",max:"150",value:v,onChange:e=>g(parseInt(e.target.value))}),(0,t.jsx)("span",{children:(.1*v).toFixed(1)})]})]}),(0,t.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:"15px",alignItems:"center",width:"100%"},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[(0,t.jsx)("label",{htmlFor:"outlineWidth",children:"Outline:"}),(0,t.jsx)("input",{type:"range",id:"outlineWidth",min:"0",max:"4",value:x,onChange:e=>y(parseInt(e.target.value))}),(0,t.jsx)("span",{children:(.25*x).toFixed(2)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"colormapType",style:{marginRight:"5px"},children:"Alpha Mode:"}),(0,t.jsxs)("select",{id:"colormapType",value:j,onChange:e=>{f(parseInt(e.target.value))},children:[(0,t.jsx)("option",{value:"0",children:"Restrict colorbar to range"}),(0,t.jsx)("option",{value:"1",children:"Colorbar from 0, transparent subthreshold"}),(0,t.jsx)("option",{value:"2",children:"Colorbar from 0, translucent subthreshold"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("input",{type:"checkbox",id:"showNegative",checked:w,onChange:e=>b(e.target.checked)}),(0,t.jsx)("label",{htmlFor:"showNegative",children:"Negative Colors"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("input",{type:"checkbox",id:"smooth",checked:C,onChange:e=>N(e.target.checked)}),(0,t.jsx)("label",{htmlFor:"smooth",children:"Smooth"})]})]}),(0,t.jsx)("div",{style:{width:"100%",height:512},children:(0,t.jsx)("canvas",{ref:i,style:{width:"100%",height:"100%"}})}),(0,t.jsx)("div",{style:{fontFamily:"monospace"},children:V})]})},h="https://niivue.com/demos",p=[{url:`${h}/images/FA.nii.gz`,colormap:"gray",opacity:1,visible:!1},{url:`${h}/images/V1.nii.gz`,colormap:"winter",opacity:0,visible:!1}],m={isColorbar:!0,backColor:[0,0,.2,1],show3Dcrosshair:!0,multiplanarLayout:2},v=e=>{let{nvOpts:n={}}=e;const i=(0,r.useRef)(null),a=(0,r.useRef)(null),[l,o]=(0,r.useState)(4),[c,d]=(0,r.useState)(0),[u,h]=(0,r.useState)(100),[v,g]=(0,r.useState)(!0),[x,y]=(0,r.useState)(""),j={...m,...n};(0,r.useEffect)((()=>((async()=>{if(!a.current&&i.current){console.log("Initializing Niivue...");const n=new s.FM({...j,onLocationChange:e=>y(e.string)});a.current=n,n.opts.dragMode=n.dragModes.pan,n.opts.yoke3Dto2DZoom=!0,n.setCrosshairWidth(.1),n.opts.isForceMouseClickToVoxelCenters=!0,await n.attachToCanvas(i.current),console.log("Niivue attached to canvas.");try{await n.loadVolumes(p),console.log("Volumes loaded in Niivue."),n.setInterpolation(!0),f(l),w(),n.isAlphaClipDark=v,n.scene.crosshairPos=n.vox2frac([41,46,28]),n.updateGLVolume()}catch(e){console.error("Error loading volumes:",e)}}})(),()=>{console.log("Cleaning up Niivue instance..."),a.current=null})),[]);const f=e=>{if(!a.current||!a.current.volumes||a.current.volumes.length<2)return;const n=a.current;0===e?(n.setOpacity(0,1),n.setOpacity(1,0)):e>2?(n.setOpacity(0,1),n.setOpacity(1,1)):(n.setOpacity(0,0),n.setOpacity(1,1)),2===e||4===e?n.setModulationImage(n.volumes[1].id,n.volumes[0].id):n.setModulationImage(n.volumes[1].id,""),n.opts.isV1SliceShader=e>2,n.updateGLVolume()},w=()=>{if(!a.current||!a.current.volumes||a.current.volumes.length<2)return;const e=.01*Math.min(c,u),n=.01*Math.max(c,u);a.current.volumes[0].cal_min=e,a.current.volumes[0].cal_max=n,a.current.updateGLVolume()};(0,r.useEffect)((()=>{f(l)}),[l]),(0,r.useEffect)((()=>{w()}),[c,u]),(0,r.useEffect)((()=>{a.current&&(a.current.isAlphaClipDark=v,a.current.updateGLVolume())}),[v]);return(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"15px",padding:"10px",border:"1px solid #ccc",borderRadius:"8px",marginBottom:"15px"},children:[(0,t.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"center",gap:"15px",alignItems:"center",width:"100%"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"displayMode",style:{marginRight:"5px"},children:"Display:"}),(0,t.jsxs)("select",{id:"displayMode",value:l,onChange:e=>{o(parseInt(e.target.value))},children:[(0,t.jsx)("option",{value:"0",children:"FA"}),(0,t.jsx)("option",{value:"1",children:"V1"}),(0,t.jsx)("option",{value:"2",children:"V1 modulated by FA"}),(0,t.jsx)("option",{value:"3",children:"Lines"}),(0,t.jsx)("option",{value:"4",children:"Lines modulated by FA"})]})]}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[(0,t.jsx)("label",{htmlFor:"faMin",children:"FA min:"}),(0,t.jsx)("input",{type:"range",id:"faMin",min:"0",max:"100",value:c,onChange:e=>d(parseInt(e.target.value))}),(0,t.jsx)("span",{children:(.01*c).toFixed(2)})]}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[(0,t.jsx)("label",{htmlFor:"faMax",children:"FA max:"}),(0,t.jsx)("input",{type:"range",id:"faMax",min:"0",max:"100",value:u,onChange:e=>h(parseInt(e.target.value))}),(0,t.jsx)("span",{children:(.01*u).toFixed(2)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("input",{type:"checkbox",id:"clipDark",checked:v,onChange:e=>g(e.target.checked)}),(0,t.jsx)("label",{htmlFor:"clipDark",children:"Clip Dark"})]})]}),(0,t.jsx)("div",{style:{width:"100%",height:512},children:(0,t.jsx)("canvas",{ref:i,style:{width:"100%",height:"100%"}})}),(0,t.jsx)("div",{style:{fontFamily:"monospace"},children:x})]})};var g=i(7221);const x={title:"Statistical Thresholding",sidebar_position:5},y=void 0,j={},f=[{value:"Basic Thresholding Concepts",id:"basic-thresholding-concepts",level:2},{value:"Setting Up Statistical Overlays",id:"setting-up-statistical-overlays",level:2},{value:"Adjusting Thresholds Programmatically",id:"adjusting-thresholds-programmatically",level:2},{value:"Using Different Colormaps for Positive and Negative Values",id:"using-different-colormaps-for-positive-and-negative-values",level:2},{value:"Thresholding Display Options",id:"thresholding-display-options",level:2},{value:"Controlling Outline Width",id:"controlling-outline-width",level:2},{value:"Managing Interpolation",id:"managing-interpolation",level:2},{value:"Working with Multiple Statistical Overlays",id:"working-with-multiple-statistical-overlays",level:2},{value:"Practical Example: Visualizing fMRI Results",id:"practical-example-visualizing-fmri-results",level:2},{value:"Advanced: Modulation",id:"advanced-modulation",level:2},{value:"Modulation Basics",id:"modulation-basics",level:3},{value:"Visualization of Diffusion Data",id:"visualization-of-diffusion-data",level:3},{value:"Clipping Dark Values",id:"clipping-dark-values",level:3}];function w(e){const n={code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"Statistical thresholding is a crucial technique in neuroimaging and other medical imaging disciplines, allowing researchers to visualize only statistically significant regions in their data. Niivue provides powerful and flexible thresholding capabilities that enable users to display both positive and negative statistical values, customize thresholds, and adjust visualization options around these thresholds."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Try interacting with the thresholding controls below to see their effect in real-time!"})}),"\n",(0,t.jsx)(g.A,{children:(0,t.jsx)(u,{})}),"\n",(0,t.jsx)(n.h2,{id:"basic-thresholding-concepts",children:"Basic Thresholding Concepts"}),"\n",(0,t.jsx)(n.p,{children:"Statistical maps often include both positive and negative values, representing different activation or deactivation patterns. Niivue lets you control multiple threshold parameters:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Positive Threshold"}),": The minimum positive value to display"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Positive Cap"}),": The most positive value to display"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Negative Threshold"}),": The minimum negative value to display (shown as absolute value)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Negative Cap"}),": The most negative value to display (shown as absolute value)"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Values outside these ranges are hidden or displayed differently based on your settings."}),"\n",(0,t.jsx)(n.h2,{id:"setting-up-statistical-overlays",children:"Setting Up Statistical Overlays"}),"\n",(0,t.jsx)(n.p,{children:"To apply statistical thresholding, you first need to load an image and a statistical overlay:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Create and initialize Niivue instance\nconst nv = new Niivue({\n  isColorbar: true,\n  backColor: [1, 1, 1, 1],\n  show3Dcrosshair: true\n});\nawait nv.attachToCanvas(document.getElementById('canvas'));\n\n// Load anatomical background and statistical overlay\nawait nv.loadVolumes([\n  { \n    url: '/path/to/anatomical.nii.gz',\n    colormap: 'gray'\n  },\n  {\n    url: '/path/to/statistical.nii.gz',\n    colormap: 'warm',\n    colormapNegative: 'winter',\n    cal_min: 3.0,\n    cal_max: 6.0,\n    cal_minNeg: -6.0,\n    cal_maxNeg: -3.0 \n  }\n]);\n\n// Hide colorbar for anatomical image (optional)\nnv.volumes[0].colorbarVisible = false;\n"})}),"\n",(0,t.jsx)(n.h2,{id:"adjusting-thresholds-programmatically",children:"Adjusting Thresholds Programmatically"}),"\n",(0,t.jsx)(n.p,{children:"You can adjust thresholds programmatically after loading the volumes:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Get the statistical overlay (second volume)\nconst statOverlay = nv.volumes[1];\n\n// Set positive thresholds\nstatOverlay.cal_min = 3.0;  // Show values above 3.0\nstatOverlay.cal_max = 6.0;  // Cap display at 6.0\n\n// Set negative thresholds\nstatOverlay.cal_minNeg = -6.0;  // Cap display at -6.0\nstatOverlay.cal_maxNeg = -3.0;  // Show values below -3.0\n\n// Update the display\nnv.updateGLVolume();\n"})}),"\n",(0,t.jsx)(n.h2,{id:"using-different-colormaps-for-positive-and-negative-values",children:"Using Different Colormaps for Positive and Negative Values"}),"\n",(0,t.jsx)(n.p,{children:"A common practice in statistical visualization is to use different colormaps for positive and negative values. Niivue makes this easy:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Set a warm colormap (red-yellow) for positive values\nnv.setColormap(statOverlay.id, 'warm');\n\n// Set a cool colormap (blue-cyan) for negative values\nnv.setColormapNegative(statOverlay.id, 'winter');\n\n// To disable negative colormap (show only positive values)\n// nv.setColormapNegative(statOverlay.id, '');\n"})}),"\n",(0,t.jsx)(n.h2,{id:"thresholding-display-options",children:"Thresholding Display Options"}),"\n",(0,t.jsx)(n.p,{children:"Niivue provides different ways to handle values below the threshold:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Set the colormap type (0, 1, or 2)\nstatOverlay.colormapType = 0;\nnv.updateGLVolume();\n"})}),"\n",(0,t.jsx)(n.p,{children:"The colormap types are:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"0"}),": Restrict colorbar to range (default)"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"1"}),": Colorbar from 0, transparent subthreshold values"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"2"}),": Colorbar from 0, translucent subthreshold values"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"controlling-outline-width",children:"Controlling Outline Width"}),"\n",(0,t.jsx)(n.p,{children:"When displaying thresholded values, you can control the width of the outline around clusters:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Set the overlay outline width (0 = no outline)\nnv.overlayOutlineWidth = 0.25;\nnv.updateGLVolume();\n"})}),"\n",(0,t.jsx)(n.h2,{id:"managing-interpolation",children:"Managing Interpolation"}),"\n",(0,t.jsx)(n.p,{children:"Interpolation can affect how thresholded values are displayed:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Enable or disable interpolation\n// false = nearest neighbor (recommended for binary/thresholded data)\n// true = linear interpolation (smoother appearance)\nnv.setInterpolation(true);\n"})}),"\n",(0,t.jsx)(n.p,{children:"When interpolation is enabled (default), voxels at the boundary of your threshold are smoothed, which can create a more aesthetically pleasing image but may slightly alter which voxels appear to survive thresholding."}),"\n",(0,t.jsx)(n.h2,{id:"working-with-multiple-statistical-overlays",children:"Working with Multiple Statistical Overlays"}),"\n",(0,t.jsx)(n.p,{children:"You can load and threshold multiple overlays simultaneously:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"await nv.loadVolumes([\n  { url: '/path/to/anatomical.nii.gz', colormap: 'gray' },\n  { \n    url: '/path/to/contrast1.nii.gz',\n    colormap: 'warm',\n    colormapNegative: 'winter',\n    cal_min: 3.0,\n    cal_max: 6.0\n  },\n  { \n    url: '/path/to/contrast2.nii.gz',\n    colormap: 'copper',\n    cal_min: 2.5,\n    cal_max: 5.0,\n    opacity: 0.7\n  }\n]);\n"})}),"\n",(0,t.jsx)(n.h2,{id:"practical-example-visualizing-fmri-results",children:"Practical Example: Visualizing fMRI Results"}),"\n",(0,t.jsx)(n.p,{children:"Here's a complete example showing how to visualize fMRI statistical results:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Create Niivue instance with a white background\nconst nv = new Niivue({\n  isColorbar: true,\n  backColor: [1, 1, 1, 1],\n  show3Dcrosshair: true\n});\nawait nv.attachToCanvas(document.getElementById('canvas'));\n\n// Load anatomical background and statistical overlay\nawait nv.loadVolumes([\n  { \n    url: '/path/to/mni152.nii.gz',\n    colormap: 'gray'\n  },\n  {\n    url: '/path/to/tstat.nii.gz',\n    colormap: 'warm',\n    colormapNegative: 'winter',\n    cal_min: 3.1,      // t > 3.1\n    cal_max: 6.0,      // Maximum display value\n    cal_minNeg: -6.0,  // Minimum display value\n    cal_maxNeg: -3.1   // t < -3.1\n  }\n]);\n\n// Hide colorbar for anatomical scan\nnv.volumes[0].colorbarVisible = false;\n\n// Set outline width\nnv.overlayOutlineWidth = 0.25;\n\n// Update display\nnv.updateGLVolume();\n"})}),"\n",(0,t.jsx)(n.h2,{id:"advanced-modulation",children:"Advanced: Modulation"}),"\n",(0,t.jsx)(n.p,{children:"Niivue supports modulating one image using another. This feature allows visualization of images where one property (like directionality) is weighted by another property (like anisotropy)."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Try interacting with the modulation controls below!"})}),"\n",(0,t.jsx)(g.A,{children:(0,t.jsx)(v,{})}),"\n",(0,t.jsx)(n.h3,{id:"modulation-basics",children:"Modulation Basics"}),"\n",(0,t.jsx)(n.p,{children:"Modulation is particularly useful when visualizing diffusion tensor imaging (DTI) data, where you might want to show primary diffusion direction (V1) modulated by fractional anisotropy (FA). This enhances visualization by emphasizing directions only in areas with high anisotropy."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Load FA and V1 volumes\nawait nv.loadVolumes([\n  {\n    url: '/path/to/FA.nii.gz',\n    opacity: 1,\n  },\n  {\n    url: '/path/to/V1.nii.gz',\n    opacity: 1,\n  }\n]);\n\n// Modulate V1 by FA\nnv.setModulationImage(nv.volumes[1].id, nv.volumes[0].id);\n\n// Set minimum FA threshold to display\nnv.volumes[0].cal_min = 0.2;\nnv.updateGLVolume();\n"})}),"\n",(0,t.jsx)(n.h3,{id:"visualization-of-diffusion-data",children:"Visualization of Diffusion Data"}),"\n",(0,t.jsx)(n.p,{children:"Niivue provides several ways to visualize diffusion data:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"FA Only"}),": Show only the fractional anisotropy map"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"V1 Only"}),": Show only the primary eigenvector direction map"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"V1 modulated by FA"}),": Show the direction map with intensity modulated by FA"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Lines"}),": Show orientation lines representing fiber directions"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Lines modulated by FA"}),": Show orientation lines with intensity modulated by FA values"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"clipping-dark-values",children:"Clipping Dark Values"}),"\n",(0,t.jsx)(n.p,{children:"When working with modulated data, you can choose to clip dark values completely:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Enable clipping of dark values\nnv.isAlphaClipDark = true;\nnv.updateGLVolume();\n"})}),"\n",(0,t.jsx)(n.p,{children:"When this option is enabled, voxels below the threshold are completely transparent rather than being shown at reduced opacity."})]})}function b(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(w,{...e})}):w(e)}}}]);