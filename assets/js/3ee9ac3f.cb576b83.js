"use strict";(self.webpackChunk_niivue_docs=self.webpackChunk_niivue_docs||[]).push([[2794],{1184:(e,n,d)=>{d.d(n,{R:()=>s,x:()=>t});var r=d(4041);const i={},l=r.createContext(i);function s(e){const n=r.useContext(l);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(l.Provider,{value:n},e.children)}},5139:(e,n,d)=>{d.r(n),d.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>a,frontMatter:()=>s,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"events","title":"Event System (EventTarget API)","description":"NiiVue implements the browser-native EventTarget API. This supports multiple listeners per event, standard options (once, signal), and coexists with legacy callback properties.","source":"@site/docs/events.mdx","sourceDirName":".","slug":"/events","permalink":"/docs/events","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":15,"frontMatter":{"title":"Event System (EventTarget API)","sidebar_position":15},"sidebar":"tutorialSidebar","previous":{"title":"DICOM","permalink":"/docs/dicom"},"next":{"title":"Plugins","permalink":"/docs/plugins"}}');var i=d(1085),l=d(1184);const s={title:"Event System (EventTarget API)",sidebar_position:15},t=void 0,c={},h=[{value:"Usage",id:"usage",level:2},{value:"Adding and removing listeners",id:"adding-and-removing-listeners",level:3},{value:"One-time listeners",id:"one-time-listeners",level:3},{value:"AbortController",id:"abortcontroller",level:3},{value:"Available Events",id:"available-events",level:2},{value:"User Interaction",id:"user-interaction",level:3},{value:"Loading",id:"loading",level:3},{value:"View Control",id:"view-control",level:3},{value:"Shaders",id:"shaders",level:3},{value:"Rendering",id:"rendering",level:3},{value:"Drawing",id:"drawing",level:3},{value:"Configuration",id:"configuration",level:3},{value:"TypeScript",id:"typescript",level:2},{value:"Backward Compatibility",id:"backward-compatibility",level:2},{value:"See Also",id:"see-also",level:2}];function o(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["NiiVue implements the browser-native ",(0,i.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/EventTarget",children:"EventTarget"})," API. This supports multiple listeners per event, standard options (",(0,i.jsx)(n.code,{children:"once"}),", ",(0,i.jsx)(n.code,{children:"signal"}),"), and coexists with legacy callback properties."]}),"\n",(0,i.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,i.jsx)(n.h3,{id:"adding-and-removing-listeners",children:"Adding and removing listeners"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"const nv = new Niivue();\nnv.attachToCanvas(document.getElementById('gl'));\n\n// Add a listener\nconst handler = (event) => {\n  console.log('Location:', event.detail);\n};\nnv.addEventListener('locationChange', handler);\n\n// Remove it\nnv.removeEventListener('locationChange', handler);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"one-time-listeners",children:"One-time listeners"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"nv.addEventListener('imageLoaded', (event) => {\n  console.log('First image loaded:', event.detail.name);\n}, { once: true });\n"})}),"\n",(0,i.jsx)(n.h3,{id:"abortcontroller",children:"AbortController"}),"\n",(0,i.jsxs)(n.p,{children:["Use an ",(0,i.jsx)(n.code,{children:"AbortController"})," to remove multiple listeners at once:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"const controller = new AbortController();\n\nnv.addEventListener('locationChange', handler1, { signal: controller.signal });\nnv.addEventListener('intensityChange', handler2, { signal: controller.signal });\n\n// Remove all listeners registered with this signal\ncontroller.abort();\n"})}),"\n",(0,i.jsx)(n.h2,{id:"available-events",children:"Available Events"}),"\n",(0,i.jsx)(n.h3,{id:"user-interaction",children:"User Interaction"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Event"}),(0,i.jsx)(n.th,{children:"Detail Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"dragRelease"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"DragReleaseParams"})}),(0,i.jsx)(n.td,{children:"Drag operation released"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"mouseUp"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Partial<UIData>"})}),(0,i.jsx)(n.td,{children:"Mouse button released"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"locationChange"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"unknown"})}),(0,i.jsx)(n.td,{children:"Crosshair location changed"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"intensityChange"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"NVImage"})}),(0,i.jsx)(n.td,{children:"Intensity values changed"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"clickToSegment"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ mm3: number; mL: number }"})}),(0,i.jsx)(n.td,{children:"Click-to-segment completed"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"measurementCompleted"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"CompletedMeasurement"})}),(0,i.jsx)(n.td,{children:"Distance measurement line completed"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"angleCompleted"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"CompletedAngle"})}),(0,i.jsx)(n.td,{children:"Angle measurement completed"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"frameChange"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ volume: NVImage; index: number }"})}),(0,i.jsx)(n.td,{children:"4D frame changed"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"loading",children:"Loading"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Event"}),(0,i.jsx)(n.th,{children:"Detail Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"imageLoaded"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"NVImage"})}),(0,i.jsx)(n.td,{children:"Image/volume loaded"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"meshLoaded"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"NVMesh"})}),(0,i.jsx)(n.td,{children:"Mesh loaded"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"volumeAddedFromUrl"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ imageOptions, volume }"})}),(0,i.jsx)(n.td,{children:"Volume added from URL"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"volumeWithUrlRemoved"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ url: string }"})}),(0,i.jsx)(n.td,{children:"URL-loaded volume removed"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"volumeRemoved"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ volume: NVImage; index: number }"})}),(0,i.jsx)(n.td,{children:"Any volume removed from scene"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"volumeUpdated"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"void"})}),(0,i.jsx)(n.td,{children:"Volume updated"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"meshAddedFromUrl"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ meshOptions, mesh }"})}),(0,i.jsx)(n.td,{children:"Mesh added from URL"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"meshWithUrlRemoved"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ url: string }"})}),(0,i.jsx)(n.td,{children:"URL-loaded mesh removed"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"meshRemoved"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ mesh: NVMesh }"})}),(0,i.jsx)(n.td,{children:"Any mesh removed from scene"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"documentLoaded"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"NVDocument"})}),(0,i.jsx)(n.td,{children:"Document loaded"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"dicomLoaderFinished"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ files: (NVImage|NVMesh)[] }"})}),(0,i.jsx)(n.td,{children:"DICOM loader finished"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"view-control",children:"View Control"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Event"}),(0,i.jsx)(n.th,{children:"Detail Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"azimuthElevationChange"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ azimuth: number; elevation: number }"})}),(0,i.jsx)(n.td,{children:"3D view rotation changed"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"clipPlaneChange"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ clipPlane: number[] }"})}),(0,i.jsx)(n.td,{children:"Clip plane changed"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"sliceTypeChange"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ sliceType: SLICE_TYPE }"})}),(0,i.jsx)(n.td,{children:"View layout changed (axial, coronal, etc.)"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"shaders",children:"Shaders"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Event"}),(0,i.jsx)(n.th,{children:"Detail Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"customMeshShaderAdded"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ fragmentShaderText, name }"})}),(0,i.jsx)(n.td,{children:"Custom shader added"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"meshShaderChanged"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ meshIndex, shaderIndex }"})}),(0,i.jsx)(n.td,{children:"Mesh shader changed"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"meshPropertyChanged"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ meshIndex, key, value }"})}),(0,i.jsx)(n.td,{children:"Mesh property changed"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"rendering",children:"Rendering"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Event"}),(0,i.jsx)(n.th,{children:"Detail Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"volumeOrderChanged"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ volumes: NVImage[] }"})}),(0,i.jsx)(n.td,{children:"Volume stacking order changed"})]})})]}),"\n",(0,i.jsx)(n.h3,{id:"drawing",children:"Drawing"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Event"}),(0,i.jsx)(n.th,{children:"Detail Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"penValueChanged"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ penValue: number; isFilledPen: boolean }"})}),(0,i.jsx)(n.td,{children:"Drawing pen value changed"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"drawingToolChanged"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ tool: string; penValue: number; isFilledPen: boolean }"})}),(0,i.jsx)(n.td,{children:"Active drawing tool changed (high-level interpretation)"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"drawingChanged"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ action: string }"})}),(0,i.jsxs)(n.td,{children:["Drawing bitmap materially changed (",(0,i.jsx)(n.code,{children:"'draw'"}),", ",(0,i.jsx)(n.code,{children:"'undo'"}),", ",(0,i.jsx)(n.code,{children:"'load'"}),", ",(0,i.jsx)(n.code,{children:"'close'"}),")"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"drawingEnabled"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ enabled: boolean }"})}),(0,i.jsx)(n.td,{children:"Drawing mode toggled on or off"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Event"}),(0,i.jsx)(n.th,{children:"Detail Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsx)(n.tbody,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"optsChange"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"{ propertyName, newValue, oldValue }"})}),(0,i.jsx)(n.td,{children:"Options changed"})]})})]}),"\n",(0,i.jsx)(n.h2,{id:"typescript",children:"TypeScript"}),"\n",(0,i.jsx)(n.p,{children:"Events are fully typed. The detail type is inferred from the event name:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"nv.addEventListener('azimuthElevationChange', (event) => {\n  const { azimuth, elevation } = event.detail;\n});\n\nnv.addEventListener('imageLoaded', (event) => {\n  console.log(event.detail.name, event.detail.dims);\n});\n"})}),"\n",(0,i.jsx)(n.h2,{id:"backward-compatibility",children:"Backward Compatibility"}),"\n",(0,i.jsx)(n.p,{children:"Legacy callback properties continue to work. When both are registered, events fire before callbacks:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"nv.onLocationChange = (location) => { /* callback */ };\nnv.addEventListener('locationChange', (event) => { /* event */ });\n// Both fire; event first, then callback\n"})}),"\n",(0,i.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/EventTarget",children:"MDN: EventTarget"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/AbortController",children:"MDN: AbortController"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/api",children:"NiiVue API Documentation"})}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}}}]);