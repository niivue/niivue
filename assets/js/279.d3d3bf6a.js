(self.webpackChunk_niivue_docs=self.webpackChunk_niivue_docs||[]).push([[279],{333:(t,e,n)=>{"use strict";n.d(e,{Bw:()=>a,S8:()=>o,fA:()=>s,hs:()=>r});var i=n(3172);function s(t,e){var n=new i.tb(2);return n[0]=t,n[1]=e,n}function r(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function a(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function o(t,e){var n=e[0],i=e[1],s=n*n+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t}var h,c;h=new i.tb(2),i.tb!=Float32Array&&(h[0]=0,h[1]=0),c=h},543:(t,e,n)=>{"use strict";n.d(e,{Jt:()=>_});var i=n(7687),s=n(1959);class r extends Error{constructor(t){super(t),this.name="IndexError"}}function a(t,e){t.length>e.length&&function(t,e){throw new r(`too many indicies for array; expected ${e.length}, got ${t.length}`)}(t,e)}function o(t,e){return(t=Math.trunc(t))<0&&(t=e+t),(t>=e||t<0)&&function(t){throw new r(`index out of bounds for dimension with length ${t}`)}(e),t}class h{dim_sel;dim_len;dim_chunk_len;nitems;constructor({dim_sel:t,dim_len:e,dim_chunk_len:n}){t=o(t,e),this.dim_sel=t,this.dim_len=e,this.dim_chunk_len=n,this.nitems=1}*[Symbol.iterator](){const t=Math.floor(this.dim_sel/this.dim_chunk_len),e=t*this.dim_chunk_len,n=this.dim_sel-e;yield{dim_chunk_ix:t,dim_chunk_sel:n}}}class c{start;stop;step;dim_len;dim_chunk_len;nitems;nchunks;constructor({dim_sel:t,dim_len:e,dim_chunk_len:n}){const[i,a,o]=(0,s.LS)(t,e);this.start=i,this.stop=a,this.step=o,this.step<1&&function(){throw new r("only slices with step >= 1 are supported")}(),this.dim_len=e,this.dim_chunk_len=n,this.nitems=Math.max(0,Math.ceil((this.stop-this.start)/this.step)),this.nchunks=Math.ceil(this.dim_len/this.dim_chunk_len)}*[Symbol.iterator](){const t=Math.floor(this.start/this.dim_chunk_len),e=Math.ceil(this.stop/this.dim_chunk_len);for(const n of(0,s.y1)(t,e)){const t=n*this.dim_chunk_len,e=Math.min(this.dim_len,(n+1)*this.dim_chunk_len),i=e-t;let s=0,r=0;if(this.start<t){const e=(t-this.start)%this.step;e&&(r+=this.step-e),s=Math.ceil((t-this.start)/this.step)}else r=this.start-t;const a=this.stop>e?i:this.stop-t,o=[r,a,this.step],h=[s,s+Math.ceil((a-r)/this.step),1];yield{dim_chunk_ix:n,dim_chunk_sel:o,dim_out_sel:h}}}}class l{dim_indexers;shape;constructor({selection:t,shape:e,chunk_shape:n}){this.dim_indexers=function(t,e){let n=[];return null===t?n=e.map((t=>(0,s.di)(null))):Array.isArray(t)&&(n=t.map((t=>t??(0,s.di)(null)))),a(n,e),n}(t,e).map(((t,i)=>new("number"==typeof t?h:c)({dim_sel:t,dim_len:e[i],dim_chunk_len:n[i]}))),this.shape=this.dim_indexers.filter((t=>t instanceof c)).map((t=>t.nitems))}*[Symbol.iterator](){for(const t of(0,s.qM)(...this.dim_indexers)){const e=t.map((t=>t.dim_chunk_ix)),n=t.map((t=>"dim_out_sel"in t?{from:t.dim_chunk_sel,to:t.dim_out_sel}:{from:t.dim_chunk_sel,to:null}));yield{chunk_coords:e,mapping:n}}}}function f(t,e=0,n){let i=n??t.length-e;return{length:i,subarray:(n,s=i)=>f(t,e+n,s-n),set(n,i=0){for(let s=0;s<n.length;s++)t[e+i+s]=n.get(s)},get:n=>t[e+n]}}function u(t){return globalThis.Array.isArray(t.data)?{data:f(t.data),stride:t.stride,bytes_per_element:1}:{data:new Uint8Array(t.data.buffer,t.data.byteOffset,t.data.byteLength),stride:t.stride,bytes_per_element:t.data.BYTES_PER_ELEMENT}}const d={prepare:(t,e,n)=>({data:t,shape:e,stride:n}),set_scalar(t,e,n){let i=u(t);p(i,e,function(t,e){if(globalThis.Array.isArray(t.data))return f([e]);let n=new(function(t){return"chars"in t?t.constructor.bind(null,t.chars):t.constructor}(t.data))([e]);return new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}(t,n),i.bytes_per_element)},set_from_chunk(t,e,n){let i=u(t);m(i,u(e),i.bytes_per_element,n)}};async function _(t,e=null,n={}){return async function(t,e,n,r){let a=(0,i.JD)(t),o=new l({selection:e,shape:t.shape,chunk_shape:t.chunks}),h=r.prepare(new a.TypedArray(o.shape.reduce(((t,e)=>t*e),1)),o.shape,a.get_strides(o.shape)),c=n.create_queue?.()??(0,s.XB)();for(const{chunk_coords:i,mapping:s}of o)c.add((async()=>{let{data:e,shape:a,stride:o}=await t.getChunk(i,n.opts),c=r.prepare(e,a,o);r.set_from_chunk(h,c,s)}));return await c.onIdle(),0===o.shape.length?function(t,e){return"get"in t?t.get(e):t[e]}(h.data,0):h}(t,e,n,d)}function g(t,e,n){return n<0&&e<t?Math.floor((t-e-1)/-n)+1:t<e?Math.floor((e-t-1)/n)+1:0}function p(t,e,n,i){if(0===e.length)return void t.data.set(n,0);const[s,...r]=e,[a,...o]=t.stride;if("number"==typeof s){return void p({data:t.data.subarray(a*s*i),stride:o},r,n,i)}const[h,c,l]=s,f=g(h,c,l);if(0!==r.length)for(let u=0;u<f;u++){p({data:t.data.subarray(a*(h+l*u)*i),stride:o},r,n,i)}else for(let u=0;u<f;u++)t.data.set(n,a*(h+l*u)*i)}function m(t,e,n,i){const[s,...r]=i,[a,...o]=t.stride,[h,...c]=e.stride;if(null===s.from)return 0===r.length?void t.data.set(e.data.subarray(0,n),s.to*n):void m({data:t.data.subarray(a*s.to*n),stride:o},e,n,r);if(null===s.to){if(0===r.length){let i=s.from*n;return void t.data.set(e.data.subarray(i,i+n),0)}return void m(t,{data:e.data.subarray(h*s.from*n),stride:c},n,r)}const[l,f,u]=s.to,[d,_,p]=s.from,y=g(l,f,u);if(0!==r.length)for(let g=0;g<y;g++)m({data:t.data.subarray(a*(l+g*u)*n),stride:o},{data:e.data.subarray(h*(d+g*p)*n),stride:c},n,r);else{if(1===u&&1===p&&1===a&&1===h){let i=d*n,s=y*n;return void t.data.set(e.data.subarray(i,i+s),l*n)}for(let i=0;i<y;i++){let s=h*(d+p*i)*n;t.data.set(e.data.subarray(s,s+n),a*(l+u*i)*n)}}}},911:(t,e,n)=>{"use strict";n.d(e,{WQ:()=>o,Z0:()=>c,fA:()=>a,hs:()=>h,jb:()=>f,o8:()=>r,vt:()=>s});var i=n(3172);function s(){var t=new i.tb(4);return i.tb!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function r(t){var e=new i.tb(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function a(t,e,n,s){var r=new i.tb(4);return r[0]=t,r[1]=e,r[2]=n,r[3]=s,r}function o(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function h(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function c(t,e,n){var i=e[0],s=e[1],r=e[2],a=e[3];return t[0]=n[0]*i+n[4]*s+n[8]*r+n[12]*a,t[1]=n[1]*i+n[5]*s+n[9]*r+n[13]*a,t[2]=n[2]*i+n[6]*s+n[10]*r+n[14]*a,t[3]=n[3]*i+n[7]*s+n[11]*r+n[15]*a,t}var l,f=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t};l=s()},1959:(t,e,n)=>{"use strict";function*i(t,e,n=1){void 0===e&&(e=t,t=0);for(let i=t;i<e;i+=n)yield i}function*s(...t){if(0===t.length)return;const e=t.map((t=>t[Symbol.iterator]())),n=e.map((t=>t.next()));if(n.some((t=>t.done)))throw new Error("Input contains an empty iterator.");for(let i=0;;){if(n[i].done){if(e[i]=t[i][Symbol.iterator](),n[i]=e[i].next(),++i>=e.length)return}else yield n.map((({value:t})=>t)),i=0;n[i]=e[i].next()}}function r({start:t,stop:e,step:n},i){if(0===n)throw new Error("slice step cannot be zero");const s=(n=n??1)<0,[r,a]=s?[-1,i-1]:[0,i];return null===t?t=s?a:r:t<0?(t+=i)<r&&(t=r):t>a&&(t=a),null===e?e=s?r:a:e<0?(e+=i)<r&&(e=r):e>a&&(e=a),[t,e,n]}function a(t,e,n=null){return void 0===e&&(e=t,t=null),{start:t,stop:e,step:n}}function o(){const t=[];return{add:e=>t.push(e()),onIdle:()=>Promise.all(t)}}n.d(e,{LS:()=>r,XB:()=>o,di:()=>a,qM:()=>s,y1:()=>i})},2651:(t,e,n)=>{"use strict";n.d(e,{i:()=>r});var i=n(8553);const s="object"==typeof self?self:globalThis,r=t=>((t,e)=>{const n=(e,n)=>(t.set(n,e),e),r=a=>{if(t.has(a))return t.get(a);const[o,h]=e[a];switch(o){case i.uT:case i.tV:return n(h,a);case i.sO:{const t=n([],a);for(const e of h)t.push(r(e));return t}case i.qv:{const t=n({},a);for(const[e,n]of h)t[r(e)]=r(n);return t}case i.vH:return n(new Date(h),a);case i.Wm:{const{source:t,flags:e}=h;return n(new RegExp(t,e),a)}case i.lC:{const t=n(new Map,a);for(const[e,n]of h)t.set(r(e),r(n));return t}case i.rK:{const t=n(new Set,a);for(const e of h)t.add(r(e));return t}case i.ff:{const{name:t,message:e}=h;return n(new s[t](e),a)}case i.Ei:return n(BigInt(h),a);case"BigInt":return n(Object(BigInt(h)),a);case"ArrayBuffer":return n(new Uint8Array(h).buffer,h);case"DataView":{const{buffer:t}=new Uint8Array(h);return n(new DataView(t),h)}}return n(new s[o](h),a)};return r})(new Map,t)(0)},2859:(t,e,n)=>{"use strict";n.d(e,{a:()=>s});var i=n(5976);class s{littleEndian=!1;dim_info=0;dims=[];intent_p1=0;intent_p2=0;intent_p3=0;intent_code=0;datatypeCode=0;numBitsPerVoxel=0;slice_start=0;slice_end=0;slice_code=0;pixDims=[];vox_offset=0;scl_slope=1;scl_inter=0;xyzt_units=0;cal_max=0;cal_min=0;slice_duration=0;toffset=0;description="";aux_file="";intent_name="";qform_code=0;sform_code=0;quatern_a=0;quatern_b=0;quatern_c=0;quatern_d=0;qoffset_x=0;qoffset_y=0;qoffset_z=0;affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];qfac=1;quatern_R;magic="0";isHDR=!1;extensionFlag=[0,0,0,0];extensionSize=0;extensionCode=0;extensions=[];static TYPE_NONE=0;static TYPE_BINARY=1;static TYPE_UINT8=2;static TYPE_INT16=4;static TYPE_INT32=8;static TYPE_FLOAT32=16;static TYPE_COMPLEX64=32;static TYPE_FLOAT64=64;static TYPE_RGB24=128;static TYPE_INT8=256;static TYPE_UINT16=512;static TYPE_UINT32=768;static TYPE_INT64=1024;static TYPE_UINT64=1280;static TYPE_FLOAT128=1536;static TYPE_COMPLEX128=1792;static TYPE_COMPLEX256=2048;static XFORM_UNKNOWN=0;static XFORM_SCANNER_ANAT=1;static XFORM_ALIGNED_ANAT=2;static XFORM_TALAIRACH=3;static XFORM_MNI_152=4;static SPATIAL_UNITS_MASK=7;static TEMPORAL_UNITS_MASK=56;static UNITS_UNKNOWN=0;static UNITS_METER=1;static UNITS_MM=2;static UNITS_MICRON=3;static UNITS_SEC=8;static UNITS_MSEC=16;static UNITS_USEC=24;static UNITS_HZ=32;static UNITS_PPM=40;static UNITS_RADS=48;static MAGIC_COOKIE=348;static STANDARD_HEADER_SIZE=348;static MAGIC_NUMBER_LOCATION=344;static MAGIC_NUMBER=[110,43,49];static MAGIC_NUMBER2=[110,105,49];static EXTENSION_HEADER_SIZE=8;readHeader(t){var e,n,r,a,o=new DataView(t),h=i.A.getIntAt(o,0,this.littleEndian);if(h!==s.MAGIC_COOKIE&&(this.littleEndian=!0,h=i.A.getIntAt(o,0,this.littleEndian)),h!==s.MAGIC_COOKIE)throw new Error("This does not appear to be a NIFTI file!");for(this.dim_info=i.A.getByteAt(o,39),e=0;e<8;e+=1)a=40+2*e,this.dims[e]=i.A.getShortAt(o,a,this.littleEndian);for(this.intent_p1=i.A.getFloatAt(o,56,this.littleEndian),this.intent_p2=i.A.getFloatAt(o,60,this.littleEndian),this.intent_p3=i.A.getFloatAt(o,64,this.littleEndian),this.intent_code=i.A.getShortAt(o,68,this.littleEndian),this.datatypeCode=i.A.getShortAt(o,70,this.littleEndian),this.numBitsPerVoxel=i.A.getShortAt(o,72,this.littleEndian),this.slice_start=i.A.getShortAt(o,74,this.littleEndian),e=0;e<8;e+=1)a=76+4*e,this.pixDims[e]=i.A.getFloatAt(o,a,this.littleEndian);if(this.vox_offset=i.A.getFloatAt(o,108,this.littleEndian),this.scl_slope=i.A.getFloatAt(o,112,this.littleEndian),this.scl_inter=i.A.getFloatAt(o,116,this.littleEndian),this.slice_end=i.A.getShortAt(o,120,this.littleEndian),this.slice_code=i.A.getByteAt(o,122),this.xyzt_units=i.A.getByteAt(o,123),this.cal_max=i.A.getFloatAt(o,124,this.littleEndian),this.cal_min=i.A.getFloatAt(o,128,this.littleEndian),this.slice_duration=i.A.getFloatAt(o,132,this.littleEndian),this.toffset=i.A.getFloatAt(o,136,this.littleEndian),this.description=i.A.getStringAt(o,148,228),this.aux_file=i.A.getStringAt(o,228,252),this.qform_code=i.A.getShortAt(o,252,this.littleEndian),this.sform_code=i.A.getShortAt(o,254,this.littleEndian),this.quatern_b=i.A.getFloatAt(o,256,this.littleEndian),this.quatern_c=i.A.getFloatAt(o,260,this.littleEndian),this.quatern_d=i.A.getFloatAt(o,264,this.littleEndian),this.quatern_a=Math.sqrt(1-(Math.pow(this.quatern_b,2)+Math.pow(this.quatern_c,2)+Math.pow(this.quatern_d,2))),this.qoffset_x=i.A.getFloatAt(o,268,this.littleEndian),this.qoffset_y=i.A.getFloatAt(o,272,this.littleEndian),this.qoffset_z=i.A.getFloatAt(o,276,this.littleEndian),this.qform_code<1&&this.sform_code<1&&(this.affine[0][0]=this.pixDims[1],this.affine[1][1]=this.pixDims[2],this.affine[2][2]=this.pixDims[3]),this.qform_code>0&&this.sform_code<this.qform_code){const t=this.quatern_a,e=this.quatern_b,i=this.quatern_c,s=this.quatern_d;for(this.qfac=0===this.pixDims[0]?1:this.pixDims[0],this.quatern_R=[[t*t+e*e-i*i-s*s,2*e*i-2*t*s,2*e*s+2*t*i],[2*e*i+2*t*s,t*t+i*i-e*e-s*s,2*i*s-2*t*e],[2*e*s-2*t*i,2*i*s+2*t*e,t*t+s*s-i*i-e*e]],n=0;n<3;n+=1)for(r=0;r<3;r+=1)this.affine[n][r]=this.quatern_R[n][r]*this.pixDims[r+1],2===r&&(this.affine[n][r]*=this.qfac);this.affine[0][3]=this.qoffset_x,this.affine[1][3]=this.qoffset_y,this.affine[2][3]=this.qoffset_z}else if(this.sform_code>0)for(n=0;n<3;n+=1)for(r=0;r<4;r+=1)a=280+4*(4*n+r),this.affine[n][r]=i.A.getFloatAt(o,a,this.littleEndian);if(this.affine[3][0]=0,this.affine[3][1]=0,this.affine[3][2]=0,this.affine[3][3]=1,this.intent_name=i.A.getStringAt(o,328,344),this.magic=i.A.getStringAt(o,344,348),this.isHDR=this.magic===String.fromCharCode.apply(null,s.MAGIC_NUMBER2),o.byteLength>s.MAGIC_COOKIE){this.extensionFlag[0]=i.A.getByteAt(o,348),this.extensionFlag[1]=i.A.getByteAt(o,349),this.extensionFlag[2]=i.A.getByteAt(o,350),this.extensionFlag[3]=i.A.getByteAt(o,351);let t=!0;!this.isHDR&&this.vox_offset<=352&&(t=!1),o.byteLength<=368&&(t=!1),t&&this.extensionFlag[0]&&(this.extensions=i.A.getExtensionsAt(o,this.getExtensionLocation(),this.littleEndian,this.vox_offset),this.extensionSize=this.extensions[0].esize,this.extensionCode=this.extensions[0].ecode)}}toFormattedString(){var t=i.A.formatNumber,e="";return e+="Dim Info = "+this.dim_info+"\n",e+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+"\n",e+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+"\n",e+="Intent Code = "+this.intent_code+"\n",e+="Datatype = "+this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+")\n",e+="Bits Per Voxel = "+this.numBitsPerVoxel+"\n",e+="Slice Start = "+this.slice_start+"\n",e+="Voxel Dimensions (1-8): "+t(this.pixDims[0])+", "+t(this.pixDims[1])+", "+t(this.pixDims[2])+", "+t(this.pixDims[3])+", "+t(this.pixDims[4])+", "+t(this.pixDims[5])+", "+t(this.pixDims[6])+", "+t(this.pixDims[7])+"\n",e+="Image Offset = "+this.vox_offset+"\n",e+="Data Scale:  Slope = "+t(this.scl_slope)+"  Intercept = "+t(this.scl_inter)+"\n",e+="Slice End = "+this.slice_end+"\n",e+="Slice Code = "+this.slice_code+"\n",e+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(s.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(s.TEMPORAL_UNITS_MASK&this.xyzt_units)+")\n",e+="Display Range:  Max = "+t(this.cal_max)+"  Min = "+t(this.cal_min)+"\n",e+="Slice Duration = "+this.slice_duration+"\n",e+="Time Axis Shift = "+this.toffset+"\n",e+='Description: "'+this.description+'"\n',e+='Auxiliary File: "'+this.aux_file+'"\n',e+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+")\n",e+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+")\n",e+="Quaternion Parameters:  b = "+t(this.quatern_b)+"  c = "+t(this.quatern_c)+"  d = "+t(this.quatern_d)+"\n",e+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+"\n",e+="S-Form Parameters X: "+t(this.affine[0][0])+", "+t(this.affine[0][1])+", "+t(this.affine[0][2])+", "+t(this.affine[0][3])+"\n",e+="S-Form Parameters Y: "+t(this.affine[1][0])+", "+t(this.affine[1][1])+", "+t(this.affine[1][2])+", "+t(this.affine[1][3])+"\n",e+="S-Form Parameters Z: "+t(this.affine[2][0])+", "+t(this.affine[2][1])+", "+t(this.affine[2][2])+", "+t(this.affine[2][3])+"\n",e+='Intent Name: "'+this.intent_name+'"\n',this.extensionFlag[0]&&(e+="Extension: Size = "+this.extensionSize+"  Code = "+this.extensionCode+"\n"),e}getDatatypeCodeString=function(t){return t===s.TYPE_UINT8?"1-Byte Unsigned Integer":t===s.TYPE_INT16?"2-Byte Signed Integer":t===s.TYPE_INT32?"4-Byte Signed Integer":t===s.TYPE_FLOAT32?"4-Byte Float":t===s.TYPE_FLOAT64?"8-Byte Float":t===s.TYPE_RGB24?"RGB":t===s.TYPE_INT8?"1-Byte Signed Integer":t===s.TYPE_UINT16?"2-Byte Unsigned Integer":t===s.TYPE_UINT32?"4-Byte Unsigned Integer":t===s.TYPE_INT64?"8-Byte Signed Integer":t===s.TYPE_UINT64?"8-Byte Unsigned Integer":"Unknown"};getTransformCodeString=function(t){return t===s.XFORM_SCANNER_ANAT?"Scanner":t===s.XFORM_ALIGNED_ANAT?"Aligned":t===s.XFORM_TALAIRACH?"Talairach":t===s.XFORM_MNI_152?"MNI":"Unknown"};getUnitsCodeString=function(t){return t===s.UNITS_METER?"Meters":t===s.UNITS_MM?"Millimeters":t===s.UNITS_MICRON?"Microns":t===s.UNITS_SEC?"Seconds":t===s.UNITS_MSEC?"Milliseconds":t===s.UNITS_USEC?"Microseconds":t===s.UNITS_HZ?"Hz":t===s.UNITS_PPM?"PPM":t===s.UNITS_RADS?"Rads":"Unknown"};getQformMat(){return this.convertNiftiQFormToNiftiSForm(this.quatern_b,this.quatern_c,this.quatern_d,this.qoffset_x,this.qoffset_y,this.qoffset_z,this.pixDims[1],this.pixDims[2],this.pixDims[3],this.pixDims[0])}convertNiftiQFormToNiftiSForm(t,e,n,i,s,r,a,o,h,c){var l,f,u,d,_=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],g=t,p=e,m=n;return _[3][0]=_[3][1]=_[3][2]=0,_[3][3]=1,(l=1-(g*g+p*p+m*m))<1e-7?(g*=l=1/Math.sqrt(g*g+p*p+m*m),p*=l,m*=l,l=0):l=Math.sqrt(l),f=a>0?a:1,u=o>0?o:1,d=h>0?h:1,c<0&&(d=-d),_[0][0]=(l*l+g*g-p*p-m*m)*f,_[0][1]=2*(g*p-l*m)*u,_[0][2]=2*(g*m+l*p)*d,_[1][0]=2*(g*p+l*m)*f,_[1][1]=(l*l+p*p-g*g-m*m)*u,_[1][2]=2*(p*m-l*g)*d,_[2][0]=2*(g*m-l*p)*f,_[2][1]=2*(p*m+l*g)*u,_[2][2]=(l*l+m*m-p*p-g*g)*d,_[0][3]=i,_[1][3]=s,_[2][3]=r,_}convertNiftiSFormToNEMA(t){var e,n,i,s,r,a,o,h,c,l,f,u,d,_,g,p,m,y,A,E,b,w,v,I,x,T,M,S,N,C,U,k,F;if(_=0,T=[[0,0,0],[0,0,0],[0,0,0]],M=[[0,0,0],[0,0,0],[0,0,0]],e=t[0][0],n=t[0][1],i=t[0][2],s=t[1][0],r=t[1][1],a=t[1][2],o=t[2][0],h=t[2][1],c=t[2][2],0===(l=Math.sqrt(e*e+s*s+o*o)))return null;if(e/=l,s/=l,o/=l,0===(l=Math.sqrt(n*n+r*r+h*h)))return null;if(l=e*(n/=l)+s*(r/=l)+o*(h/=l),Math.abs(l)>1e-4){if(n-=l*e,r-=l*s,h-=l*o,0===(l=Math.sqrt(n*n+r*r+h*h)))return null;n/=l,r/=l,h/=l}if(0===(l=Math.sqrt(i*i+a*a+c*c))?(i=s*h-o*r,a=o*n-h*e,c=e*r-s*n):(i/=l,a/=l,c/=l),l=e*i+s*a+o*c,Math.abs(l)>1e-4){if(i-=l*e,a-=l*s,c-=l*o,0===(l=Math.sqrt(i*i+a*a+c*c)))return null;i/=l,a/=l,c/=l}if(l=n*i+r*a+h*c,Math.abs(l)>1e-4){if(i-=l*n,a-=l*r,c-=l*h,0===(l=Math.sqrt(i*i+a*a+c*c)))return null;i/=l,a/=l,c/=l}if(T[0][0]=e,T[0][1]=n,T[0][2]=i,T[1][0]=s,T[1][1]=r,T[1][2]=a,T[2][0]=o,T[2][1]=h,T[2][2]=c,0===(f=this.nifti_mat33_determ(T)))return null;for(x=-666,y=b=w=v=1,A=2,E=3,u=1;u<=3;u+=1)for(d=1;d<=3;d+=1)if(u!==d)for(_=1;_<=3;_+=1)if(u!==_&&d!==_)for(M[0][0]=M[0][1]=M[0][2]=M[1][0]=M[1][1]=M[1][2]=M[2][0]=M[2][1]=M[2][2]=0,g=-1;g<=1;g+=2)for(p=-1;p<=1;p+=2)for(m=-1;m<=1;m+=2)M[0][u-1]=g,M[1][d-1]=p,M[2][_-1]=m,this.nifti_mat33_determ(M)*f>0&&(l=(I=this.nifti_mat33_mul(M,T))[0][0]+I[1][1]+I[2][2])>x&&(x=l,y=u,A=d,E=_,b=g,w=p,v=m);switch(S=N=C=U=k=F="",y*b){case 1:S="X",U="+";break;case-1:S="X",U="-";break;case 2:S="Y",U="+";break;case-2:S="Y",U="-";break;case 3:S="Z",U="+";break;case-3:S="Z",U="-"}switch(A*w){case 1:N="X",k="+";break;case-1:N="X",k="-";break;case 2:N="Y",k="+";break;case-2:N="Y",k="-";break;case 3:N="Z",k="+";break;case-3:N="Z",k="-"}switch(E*v){case 1:C="X",F="+";break;case-1:C="X",F="-";break;case 2:C="Y",F="+";break;case-2:C="Y",F="-";break;case 3:C="Z",F="+";break;case-3:C="Z",F="-"}return S+N+C+U+k+F}nifti_mat33_mul=function(t,e){var n,i,s=[[0,0,0],[0,0,0],[0,0,0]];for(n=0;n<3;n+=1)for(i=0;i<3;i+=1)s[n][i]=t[n][0]*e[0][i]+t[n][1]*e[1][i]+t[n][2]*e[2][i];return s};nifti_mat33_determ=function(t){var e,n,i,s,r,a,o,h,c;return e=t[0][0],n=t[0][1],i=t[0][2],s=t[1][0],r=t[1][1],a=t[1][2],o=t[2][0],h=t[2][1],e*r*(c=t[2][2])-e*h*a-s*n*c+s*h*i+o*n*a-o*r*i};getExtensionLocation(){return s.MAGIC_COOKIE+4}getExtensionSize(t){return i.A.getIntAt(t,this.getExtensionLocation(),this.littleEndian)}getExtensionCode(t){return i.A.getIntAt(t,this.getExtensionLocation()+4,this.littleEndian)}addExtension(t,e=-1){-1==e?this.extensions.push(t):this.extensions.splice(e,0,t),this.vox_offset+=t.esize}removeExtension(t){let e=this.extensions[t];e&&(this.vox_offset-=e.esize),this.extensions.splice(t,1)}toArrayBuffer(t=!1){let e=352;if(t)for(let r of this.extensions)e+=r.esize;let n=new Uint8Array(e),i=new DataView(n.buffer);i.setInt32(0,348,this.littleEndian),i.setUint8(39,this.dim_info);for(let r=0;r<8;r++)i.setUint16(40+2*r,this.dims[r],this.littleEndian);i.setFloat32(56,this.intent_p1,this.littleEndian),i.setFloat32(60,this.intent_p2,this.littleEndian),i.setFloat32(64,this.intent_p3,this.littleEndian),i.setInt16(68,this.intent_code,this.littleEndian),i.setInt16(70,this.datatypeCode,this.littleEndian),i.setInt16(72,this.numBitsPerVoxel,this.littleEndian),i.setInt16(74,this.slice_start,this.littleEndian);for(let r=0;r<8;r++)i.setFloat32(76+4*r,this.pixDims[r],this.littleEndian);i.setFloat32(108,this.vox_offset,this.littleEndian),i.setFloat32(112,this.scl_slope,this.littleEndian),i.setFloat32(116,this.scl_inter,this.littleEndian),i.setInt16(120,this.slice_end,this.littleEndian),i.setUint8(122,this.slice_code),i.setUint8(123,this.xyzt_units),i.setFloat32(124,this.cal_max,this.littleEndian),i.setFloat32(128,this.cal_min,this.littleEndian),i.setFloat32(132,this.slice_duration,this.littleEndian),i.setFloat32(136,this.toffset,this.littleEndian),n.set((new TextEncoder).encode(this.description),148),n.set((new TextEncoder).encode(this.aux_file),228),i.setInt16(252,this.qform_code,this.littleEndian),i.setInt16(254,this.sform_code,this.littleEndian),i.setFloat32(256,this.quatern_b,this.littleEndian),i.setFloat32(260,this.quatern_c,this.littleEndian),i.setFloat32(264,this.quatern_d,this.littleEndian),i.setFloat32(268,this.qoffset_x,this.littleEndian),i.setFloat32(272,this.qoffset_y,this.littleEndian),i.setFloat32(276,this.qoffset_z,this.littleEndian);const s=this.affine.flat();for(let r=0;r<12;r++)i.setFloat32(280+4*r,s[r],this.littleEndian);if(n.set((new TextEncoder).encode(this.intent_name),328),n.set((new TextEncoder).encode(this.magic),344),t){n.set(Uint8Array.from([1,0,0,0]),348);let t=this.getExtensionLocation();for(const e of this.extensions)i.setInt32(t,e.esize,e.littleEndian),i.setInt32(t+4,e.ecode,e.littleEndian),n.set(new Uint8Array(e.edata),t+8),t+=e.esize}else n.set(new Uint8Array(4).fill(0),348);return n.buffer}}},3172:(t,e,n)=>{"use strict";n.d(e,{p8:()=>i,tb:()=>s});var i=1e-6,s="undefined"!=typeof Float32Array?Float32Array:Array;Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},4062:(t,e,n)=>{"use strict";n.d(e,{$A:()=>p,Bw:()=>a,C:()=>h,Cc:()=>m,Il:()=>b,Re:()=>l,S8:()=>g,T9:()=>u,WQ:()=>c,fA:()=>o,g7:()=>y,hs:()=>d,jb:()=>E,jk:()=>f,o8:()=>r,vt:()=>s,ze:()=>_});var i=n(3172);function s(){var t=new i.tb(3);return i.tb!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function r(t){var e=new i.tb(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function a(t){var e=t[0],n=t[1],i=t[2];return Math.hypot(e,n,i)}function o(t,e,n){var s=new i.tb(3);return s[0]=t,s[1]=e,s[2]=n,s}function h(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function c(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function l(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function f(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function u(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function d(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function _(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function g(t,e){var n=e[0],i=e[1],s=e[2],r=n*n+i*i+s*s;return r>0&&(r=1/Math.sqrt(r)),t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function p(t,e,n){var i=e[0],s=e[1],r=e[2],a=n[0],o=n[1],h=n[2];return t[0]=s*h-r*o,t[1]=r*a-i*h,t[2]=i*o-s*a,t}function m(t,e,n,i){var s=e[0],r=e[1],a=e[2];return t[0]=s+i*(n[0]-s),t[1]=r+i*(n[1]-r),t[2]=a+i*(n[2]-a),t}function y(t,e){var n=t[0],i=t[1],s=t[2],r=e[0],a=e[1],o=e[2],h=Math.sqrt(n*n+i*i+s*s)*Math.sqrt(r*r+a*a+o*o),c=h&&function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}(t,e)/h;return Math.acos(Math.min(Math.max(c,-1),1))}var A,E=l,b=a;A=s()},4990:(t,e,n)=>{"use strict";n.d(e,{s:()=>i});class i{esize;ecode;edata;littleEndian;constructor(t,e,n,i){if(t%16!=0)throw new Error("This does not appear to be a NIFTI extension");this.esize=t,this.ecode=e,this.edata=n,this.littleEndian=i}toArrayBuffer(){let t=new Uint8Array(this.esize),e=new Uint8Array(this.edata);t.set(e,8);let n=new DataView(t.buffer);return n.setInt32(0,this.esize,this.littleEndian),n.setInt32(4,this.ecode,this.littleEndian),t.buffer}}},5798:(t,e,n)=>{"use strict";n.d(e,{l:()=>c});var i=n(8553);const s="",{toString:r}={},{keys:a}=Object,o=t=>{const e=typeof t;if("object"!==e||!t)return[i.uT,e];const n=r.call(t).slice(8,-1);switch(n){case"Array":return[i.sO,s];case"Object":return[i.qv,s];case"Date":return[i.vH,s];case"RegExp":return[i.Wm,s];case"Map":return[i.lC,s];case"Set":return[i.rK,s];case"DataView":return[i.sO,n]}return n.includes("Array")?[i.sO,n]:n.includes("Error")?[i.ff,n]:[i.qv,n]},h=([t,e])=>t===i.uT&&("function"===e||"symbol"===e),c=(t,{json:e,lossy:n}={})=>{const s=[];return((t,e,n,s)=>{const r=(t,e)=>{const i=s.push(t)-1;return n.set(e,i),i},c=s=>{if(n.has(s))return n.get(s);let[l,f]=o(s);switch(l){case i.uT:{let e=s;switch(f){case"bigint":l=i.Ei,e=s.toString();break;case"function":case"symbol":if(t)throw new TypeError("unable to serialize "+f);e=null;break;case"undefined":return r([i.tV],s)}return r([l,e],s)}case i.sO:{if(f){let t=s;return"DataView"===f?t=new Uint8Array(s.buffer):"ArrayBuffer"===f&&(t=new Uint8Array(s)),r([f,[...t]],s)}const t=[],e=r([l,t],s);for(const n of s)t.push(c(n));return e}case i.qv:{if(f)switch(f){case"BigInt":return r([f,s.toString()],s);case"Boolean":case"Number":case"String":return r([f,s.valueOf()],s)}if(e&&"toJSON"in s)return c(s.toJSON());const n=[],i=r([l,n],s);for(const e of a(s))!t&&h(o(s[e]))||n.push([c(e),c(s[e])]);return i}case i.vH:return r([l,s.toISOString()],s);case i.Wm:{const{source:t,flags:e}=s;return r([l,{source:t,flags:e}],s)}case i.lC:{const e=[],n=r([l,e],s);for(const[i,r]of s)(t||!h(o(i))&&!h(o(r)))&&e.push([c(i),c(r)]);return n}case i.rK:{const e=[],n=r([l,e],s);for(const i of s)!t&&h(o(i))||e.push(c(i));return n}}const{message:u}=s;return r([l,{name:f,message:u}],s)};return c})(!(e||n),!!e,new Map,s)(t),s}},5806:t=>{t.exports=function(t,e){var n=t.length;if(t===e)return!0;if(n!==e.length)return!1;for(var i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}},5878:(t,e,n)=>{"use strict";n.d(e,{fA:()=>r,lw:()=>a,vt:()=>s});var i=n(3172);function s(){var t=new i.tb(9);return i.tb!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function r(t,e,n,s,r,a,o,h,c){var l=new i.tb(9);return l[0]=t,l[1]=e,l[2]=n,l[3]=s,l[4]=r,l[5]=a,l[6]=o,l[7]=h,l[8]=c,l}function a(t,e,n){var i=e[0],s=e[1],r=e[2],a=e[3],o=e[4],h=e[5],c=e[6],l=e[7],f=e[8],u=n[0],d=n[1],_=n[2],g=n[3],p=n[4],m=n[5],y=n[6],A=n[7],E=n[8];return t[0]=u*i+d*a+_*c,t[1]=u*s+d*o+_*l,t[2]=u*r+d*h+_*f,t[3]=g*i+p*a+m*c,t[4]=g*s+p*o+m*l,t[5]=g*r+p*h+m*f,t[6]=y*i+A*a+E*c,t[7]=y*s+A*o+E*l,t[8]=y*r+A*h+E*f,t}},5976:(t,e,n)=>{"use strict";n.d(e,{A:()=>s});var i=n(4990);class s{static crcTable=null;static GUNZIP_MAGIC_COOKIE1=31;static GUNZIP_MAGIC_COOKIE2=139;static getStringAt(t,e,n){var i,s,r="";for(i=e;i<n;i+=1)0!==(s=t.getUint8(i))&&(r+=String.fromCharCode(s));return r}static getByteAt=function(t,e){return t.getUint8(e)};static getShortAt=function(t,e,n){return t.getInt16(e,n)};static getIntAt(t,e,n){return t.getInt32(e,n)}static getFloatAt(t,e,n){return t.getFloat32(e,n)}static getDoubleAt(t,e,n){return t.getFloat64(e,n)}static getInt64At(t,e,n){const i=t.getUint32(e,n),s=t.getInt32(e+4,n);let r;return r=n?s*2**32+i:i*2**32+s,s<0&&(r+=-1*2**32*2**32),r}static getUint64At(t,e,n){const i=t.getUint32(e+(n?0:4),n),s=t.getUint32(e+(n?4:0),n);return n?s*2**32+i:i*2**32+s}static getExtensionsAt(t,e,n,r){let a=[],o=e;for(;o<r;){let e=n,h=s.getIntAt(t,o,n);if(!h)break;if(h+o>r&&(e=!e,h=s.getIntAt(t,o,e),h+o>r))throw new Error("This does not appear to be a valid NIFTI extension");if(h%16!=0)throw new Error("This does not appear to be a NIFTI extension");let c=s.getIntAt(t,o+4,e),l=t.buffer.slice(o+8,o+h),f=new i.s(h,c,l,e);a.push(f),o+=h}return a}static toArrayBuffer(t){var e,n,i;for(e=new ArrayBuffer(t.length),n=new Uint8Array(e),i=0;i<t.length;i+=1)n[i]=t[i];return e}static isString(t){return"string"==typeof t||t instanceof String}static formatNumber(t,e=void 0){let n;return n=s.isString(t)?Number(t):t,n=e?n.toPrecision(5):n.toPrecision(7),parseFloat(n)}static makeCRCTable(){let t,e=[];for(var n=0;n<256;n++){t=n;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}static crc32(t){s.crcTable||(s.crcTable=s.makeCRCTable());const e=s.crcTable;let n=~0;for(var i=0;i<t.byteLength;i++)n=n>>>8^e[255&(n^t.getUint8(i))];return~n>>>0}}},6064:(t,e,n)=>{"use strict";n.d(e,{HM:()=>d,NO:()=>l,PQ:()=>c,X:()=>u,c7:()=>h,dq:()=>r,eg:()=>s,mF:()=>p,mf:()=>f,tz:()=>_,uV:()=>o,vA:()=>g,zA:()=>a});var i=n(6773);function s(t){const e=(new TextDecoder).decode(t);return JSON.parse(e)}function r(t,e){const n=e/2,i=e-1;let s=0;for(let r=0;r<t.length;r+=e)for(let e=0;e<n;e+=1)s=t[r+e],t[r+e]=t[r+i-e],t[r+i-e]=s}function a(t){if("v2:object"===t)return globalThis.Array;let e=t.match(/v2:([US])(\d+)/);if(e){let[,t,n]=e;return("U"===t?i.so:i.Lk).bind(null,Number(n))}let n={int8:Int8Array,int16:Int16Array,int32:Int32Array,int64:globalThis.BigInt64Array,uint8:Uint8Array,uint16:Uint16Array,uint32:Uint32Array,uint64:globalThis.BigUint64Array,float16:globalThis.Float16Array,float32:Float32Array,float64:Float64Array,bool:i.OZ}[t];return g(n,`Unknown or unsupported data_type: ${t}`),n}function o(t,e){const n=t.length;"string"==typeof e&&(e="C"===e?Array.from({length:n},((t,e)=>e)):Array.from({length:n},((t,e)=>n-1-e))),g(n===e.length,"Order length must match the number of dimensions.");let i=1,s=new Array(n);for(let r=e.length-1;r>=0;r--)s[e[r]]=i,i*=t[e[r]];return s}function h({name:t,configuration:e}){if("default"===t){const t=e?.separator??"/";return e=>["c",...e].join(t)}if("v2"===t){const t=e?.separator??".";return e=>e.join(t)||"0"}throw new Error(`Unknown chunk key encoding: ${t}`)}function c(t,e={}){let n=[],i=function(t){if("|O"===t)return{data_type:"v2:object"};let e=t.match(/^([<|>])(.*)$/);g(e,`Invalid dtype: ${t}`);let[,n,i]=e,s={b1:"bool",i1:"int8",u1:"uint8",i2:"int16",u2:"uint16",i4:"int32",u4:"uint32",i8:"int64",u8:"uint64",f2:"float16",f4:"float32",f8:"float64"}[i]??(i.startsWith("S")||i.startsWith("U")?`v2:${i}`:void 0);return g(s,`Unsupported or unknown dtype: ${t}`),"|"===n?{data_type:s}:{data_type:s,endian:"<"===n?"little":"big"}}(t.dtype);"F"===t.order&&n.push({name:"transpose",configuration:{order:"F"}}),"endian"in i&&"big"===i.endian&&n.push({name:"bytes",configuration:{endian:"big"}});for(let{id:s,...r}of t.filters??[])n.push({name:s,configuration:r});if(t.compressor){let{id:e,...i}=t.compressor;n.push({name:e,configuration:i})}return{zarr_format:3,node_type:"array",shape:t.shape,data_type:i.data_type,chunk_grid:{name:"regular",configuration:{chunk_shape:t.chunks}},chunk_key_encoding:{name:"v2",configuration:{separator:t.dimension_separator??"."}},codecs:n,fill_value:t.fill_value,attributes:e}}function l(t,e={}){return{zarr_format:3,node_type:"group",attributes:e}}function f(t,e){if("number"!==e&&"bigint"!==e&&"boolean"!==e&&"object"!==e&&"string"!==e)return t===e;let n="bool"===t;if("boolean"===e)return n;let i=t.startsWith("v2:U")||t.startsWith("v2:S");if("string"===e)return i;let s="int64"===t||"uint64"===t;if("bigint"===e)return s;let r="v2:object"===t;return"object"===e?r:!(i||s||n||r)}function u(t){return"sharding_indexed"===t?.name}function d(t){return"uint64"!==t.data_type&&"int64"!==t.data_type||null==t.fill_value?t.fill_value:BigInt(t.fill_value)}function _(t,...e){if(!e.some((e=>t instanceof e)))throw t}function g(t,e=""){if(!t)throw new Error(e)}async function p(t,{format:e,signal:n}){const i=t instanceof Response?t:new Response(t);g(i.body,"Response does not contain body.");try{const t=new Response(i.body.pipeThrough(new DecompressionStream(e),{signal:n}));return await t.arrayBuffer()}catch{throw n?.throwIfAborted(),new Error(`Failed to decode ${e}`)}}},6428:(t,e,n)=>{"use strict";n.d(e,{h:()=>l});class i extends Error{constructor(t,e={}){super(`Node not found: ${t}`,e),this.name="NodeNotFoundError"}}class s extends Error{constructor(t){super(`Missing key: ${t}`),this.name="KeyError"}}var r=n(7687),a=n(6064);let o=function(){let t=new WeakMap;function e(e){let n=t.get(e)??{v2:0,v3:0};return t.set(e,n),n}return{increment(t,n){e(t)[n]+=1},version_max(t){let n=e(t);return n.v3>n.v2?"v3":"v2"}}}();async function h(t,e){let{path:n}=t.resolve(".zarray"),h=await t.store.get(n);if(!h)throw new i("v2 array",{cause:new s(n)});return o.increment(t.store,"v2"),new r.O3(t.store,t.path,(0,a.PQ)((0,a.eg)(h),e))}async function c(t,e){let{path:n}=t.resolve(".zgroup"),h=await t.store.get(n);if(!h)throw new i("v2 group",{cause:new s(n)});return o.increment(t.store,"v2"),new r.YJ(t.store,t.path,(0,a.NO)((0,a.eg)(h),e))}async function l(t,e={}){let n="store"in t?t.store:t,s=o.version_max(n),r="v2"===s?l.v2:l.v3,h="v2"===s?l.v3:l.v2;return r(t,e).catch((n=>((0,a.tz)(n,i),h(t,e))))}l.v2=async function(t,e={}){let n="store"in t?t:new r.aZ(t),s={};return(e.attrs??1)&&(s=await async function(t){let e=await t.store.get(t.resolve(".zattrs").path);return e?(0,a.eg)(e):{}}(n)),"array"===e.kind?h(n,s):"group"===e.kind?c(n,s):h(n,s).catch((t=>((0,a.tz)(t,i),c(n,s))))},l.v3=async function(t,e={}){let n="store"in t?t:new r.aZ(t),h=await async function(t){let{store:e,path:n}=t.resolve("zarr.json"),o=await t.store.get(n);if(!o)throw new i("v3 array or group",{cause:new s(n)});let h=(0,a.eg)(o);return"array"===h.node_type&&(h.fill_value=(0,a.HM)(h)),"array"===h.node_type?new r.O3(e,t.path,h):new r.YJ(e,t.path,h)}(n);if(o.increment(n.store,"v3"),void 0===e.kind)return h;if("array"===e.kind&&h instanceof r.O3)return h;if("group"===e.kind&&h instanceof r.YJ)return h;let c=h instanceof r.O3?"array":"group";throw new Error(`Expected node of kind ${e.kind}, found ${c}.`)}},6773:(t,e,n)=>{"use strict";n.d(e,{Lk:()=>s,OZ:()=>i,so:()=>r});class i{#t;constructor(t,e,n){"number"==typeof t?this.#t=new Uint8Array(t):t instanceof ArrayBuffer?this.#t=new Uint8Array(t,e,n):this.#t=new Uint8Array(Array.from(t,(t=>t?1:0)))}get BYTES_PER_ELEMENT(){return 1}get byteOffset(){return this.#t.byteOffset}get byteLength(){return this.#t.byteLength}get buffer(){return this.#t.buffer}get length(){return this.#t.length}get(t){let e=this.#t[t];return"number"==typeof e?0!==e:e}set(t,e){this.#t[t]=e?1:0}fill(t){this.#t.fill(t?1:0)}*[Symbol.iterator](){for(let t=0;t<this.length;t++)yield this.get(t)}}class s{_data;chars;#e;constructor(t,e,n,i){if(this.chars=t,this.#e=new TextEncoder,"number"==typeof e)this._data=new Uint8Array(e*t);else if(e instanceof ArrayBuffer)i&&(i*=t),this._data=new Uint8Array(e,n,i);else{let n=Array.from(e);this._data=new Uint8Array(n.length*t);for(let t=0;t<n.length;t++)this.set(t,n[t])}}get BYTES_PER_ELEMENT(){return this.chars}get byteOffset(){return this._data.byteOffset}get byteLength(){return this._data.byteLength}get buffer(){return this._data.buffer}get length(){return this.byteLength/this.BYTES_PER_ELEMENT}get(t){const e=new Uint8Array(this.buffer,this.byteOffset+this.chars*t,this.chars);return(new TextDecoder).decode(e).replace(/\x00/g,"")}set(t,e){const n=new Uint8Array(this.buffer,this.byteOffset+this.chars*t,this.chars);n.fill(0),n.set(this.#e.encode(e))}fill(t){const e=this.#e.encode(t);for(let n=0;n<this.length;n++)this._data.set(e,n*this.chars)}*[Symbol.iterator](){for(let t=0;t<this.length;t++)yield this.get(t)}}class r{#n;chars;constructor(t,e,n,i){if(this.chars=t,"number"==typeof e)this.#n=new Int32Array(e*t);else if(e instanceof ArrayBuffer)i&&(i*=t),this.#n=new Int32Array(e,n,i);else{const n=e,i=new r(t,1);this.#n=new Int32Array(function*(){for(let t of n)i.set(0,t),yield*i.#n}())}}get BYTES_PER_ELEMENT(){return this.#n.BYTES_PER_ELEMENT*this.chars}get byteLength(){return this.#n.byteLength}get byteOffset(){return this.#n.byteOffset}get buffer(){return this.#n.buffer}get length(){return this.#n.length/this.chars}get(t){const e=this.chars*t;let n="";for(let i=0;i<this.chars;i++)n+=String.fromCodePoint(this.#n[e+i]);return n.replace(/\u0000/g,"")}set(t,e){const n=this.chars*t,i=this.#n.subarray(n,n+this.chars);i.fill(0);for(let s=0;s<this.chars;s++)i[s]=e.codePointAt(s)??0}fill(t){this.set(0,t);let e=this.#n.subarray(0,this.chars);for(let n=1;n<this.length;n++)this.#n.set(e,n*this.chars)}*[Symbol.iterator](){for(let t=0;t<this.length;t++)yield this.get(t)}}},7565:(t,e,n)=>{"use strict";n.d(e,{A:()=>r});n(4041);var i=n(1310),s=n(1085);function r(t){let{children:e,fallback:n}=t;return(0,i.A)()?(0,s.jsx)(s.Fragment,{children:e?.()}):n??null}},7687:(t,e,n)=>{"use strict";n.d(e,{O3:()=>U,YJ:()=>M,aZ:()=>x,JD:()=>C,zr:()=>T});var i=n(6064);class s{kind="array_to_array";constructor(t,e){(0,i.vA)(t.keepbits>=0,"keepbits must be zero or positive")}static fromConfig(t,e){return new s(t,e)}encode(t){throw new Error("`BitroundCodec.encode` is not implemented. Please open an issue at https://github.com/manzt/zarrita.js/issues.")}decode(t){return t}}const r=function(){const t=new Uint32Array([305419896]);return!(18===new Uint8Array(t.buffer,t.byteOffset,t.byteLength)[0])}();function a(t){return"BYTES_PER_ELEMENT"in t?t.BYTES_PER_ELEMENT:4}class o{kind="array_to_bytes";#i;#s;#r;#a;#o;constructor(t,e){this.#o=t?.endian,this.#s=(0,i.zA)(e.data_type),this.#a=e.shape,this.#i=(0,i.uV)(e.shape,"C");const n=new this.#s(0);this.#r=n.BYTES_PER_ELEMENT}static fromConfig(t,e){return new o(t,e)}encode(t){let e=new Uint8Array(t.data.buffer);return r&&"big"===this.#o&&(0,i.dq)(e,a(this.#s)),e}decode(t){return r&&"big"===this.#o&&(0,i.dq)(t,a(this.#s)),{data:new this.#s(t.buffer,t.byteOffset,t.byteLength/this.#r),shape:this.#a,stride:this.#i}}}class h{kind="bytes_to_bytes";static fromConfig(){return new h}encode(t){throw new Error("Not implemented")}decode(t){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength-4)}}class c{kind="bytes_to_bytes";static fromConfig(t){return new c}encode(t){throw new Error("Gzip encoding is not enabled by default. Please register a custom codec with `numcodecs/gzip`.")}async decode(t){const e=await(0,i.mF)(t,{format:"gzip"});return new Uint8Array(e)}}function l(t,e){return(0,i.vA)(!Number.isNaN(e),"JsonCodec allow_nan is false but NaN was encountered during encoding."),(0,i.vA)(e!==Number.POSITIVE_INFINITY,"JsonCodec allow_nan is false but Infinity was encountered during encoding."),(0,i.vA)(e!==Number.NEGATIVE_INFINITY,"JsonCodec allow_nan is false but -Infinity was encountered during encoding."),e}function f(t,e){return e instanceof Object&&!Array.isArray(e)?Object.keys(e).sort().reduce(((t,n)=>(t[n]=e[n],t)),{}):e}class u{configuration;kind="array_to_bytes";#h;#c;constructor(t={}){this.configuration=t;const{encoding:e="utf-8",skipkeys:n=!1,ensure_ascii:i=!0,check_circular:s=!0,allow_nan:r=!0,sort_keys:a=!0,indent:o,strict:h=!0}=t;let c=t.separators;c||(c=o?[", ",": "]:[",",":"]),this.#h={encoding:e,skipkeys:n,ensure_ascii:i,check_circular:s,allow_nan:r,indent:o,separators:c,sort_keys:a},this.#c={strict:h}}static fromConfig(t){return new u(t)}encode(t){const{indent:e,encoding:n,ensure_ascii:s,check_circular:r,allow_nan:a,sort_keys:o}=this.#h;(0,i.vA)("utf-8"===n,"JsonCodec does not yet support non-utf-8 encoding.");const h=[];(0,i.vA)(r,"JsonCodec does not yet support skipping the check for circular references during encoding."),a||h.push(l),o&&h.push(f);const c=Array.from(t.data);let u;c.push("|O"),c.push(t.shape),h.length&&(u=(t,e)=>{let n=e;for(let i of h)n=i(t,n);return n});let d=JSON.stringify(c,u,e);return s&&(d=d.replace(/[\u007F-\uFFFF]/g,(t=>{const e=`0000${t.charCodeAt(0).toString(16)}`;return`\\u${e.substring(e.length-4)}`}))),(new TextEncoder).encode(d)}decode(t){const{strict:e}=this.#c;(0,i.vA)(e,"JsonCodec does not yet support non-strict decoding.");const n=(0,i.eg)(t),s=n.pop();n.pop(),(0,i.vA)(s,"0D not implemented for JsonCodec.");return{data:n,shape:s,stride:(0,i.uV)(s,"C")}}}var d=n(6773);function _(t){if(t instanceof d.OZ||t instanceof d.Lk||t instanceof d.so){return new Proxy(t,{get:(t,e)=>t.get(Number(e)),set:(t,e,n)=>(t.set(Number(e),n),!0)})}return t}function g(t,e){let n=function(t,e){let n;return n=t.data instanceof d.Lk||t.data instanceof d.so?new t.constructor(t.data.length,t.data.chars):new t.constructor(t.data.length),{data:n,shape:t.shape,stride:(0,i.uV)(t.shape,e)}}(t,e),s=t.shape.length,r=t.data.length,a=Array(s).fill(0),o=_(t.data),h=_(n.data);for(let i=0;i<r;i++){let e=0;for(let t=0;t<s;t++)e+=a[t]*n.stride[t];h[e]=o[i],a[0]+=1;for(let n=0;n<s;n++)if(a[n]===t.shape[n]){if(n+1===s)break;a[n]=0,a[n+1]+=1}}return n}function p(t,e){let n=function(t){let e=t.shape.length;return(0,i.vA)(e===t.stride.length,"Shape and stride must have the same length."),t.stride.map(((t,e)=>({stride:t,index:e}))).sort(((t,e)=>e.stride-t.stride)).map((t=>t.index))}(t);return(0,i.vA)(n.length===e.length,"Orders must match"),n.every(((t,n)=>t===e[n]))}class m{kind="array_to_array";#l;#f;constructor(t,e){let n=t.order??"C",s=e.shape.length,r=new Array(s),a=new Array(s);if("C"===n)for(let i=0;i<s;++i)r[i]=i,a[i]=i;else if("F"===n)for(let i=0;i<s;++i)r[i]=s-i-1,a[i]=s-i-1;else r=n,r.forEach(((t,e)=>{(0,i.vA)(void 0===a[t],`Invalid permutation: ${JSON.stringify(n)}`),a[t]=e}));this.#l=r,this.#f=a}static fromConfig(t,e){return new m(t,e)}encode(t){return p(t,this.#f)?t:g(t,this.#f)}decode(t){return{data:t.data,shape:t.shape,stride:(0,i.uV)(t.shape,this.#l)}}}class y{kind="array_to_bytes";#a;#u;constructor(t){this.#a=t,this.#u=(0,i.uV)(t,"C")}static fromConfig(t,e){return new y(e.shape)}encode(t){throw new Error("Method not implemented.")}decode(t){let e=new TextDecoder,n=new DataView(t.buffer),i=Array(n.getUint32(0,!0)),s=4;for(let r=0;r<i.length;r++){let a=n.getUint32(s,!0);s+=4,i[r]=e.decode(t.buffer.slice(s,s+a)),s+=a}return{data:i,shape:this.#a,stride:this.#u}}}class A{kind="bytes_to_bytes";static fromConfig(t){return new A}encode(t){throw new Error("Zlib encoding is not enabled by default. Please register a codec with `numcodecs/zlib`.")}async decode(t){const e=await(0,i.mF)(t,{format:"deflate"});return new Uint8Array(e)}}const E=(new Map).set("blosc",(()=>n.e(253).then(n.bind(n,7634)).then((t=>t.default)))).set("lz4",(()=>n.e(829).then(n.bind(n,8829)).then((t=>t.default)))).set("zstd",(()=>n.e(580).then(n.bind(n,7199)).then((t=>t.default)))).set("gzip",(()=>c)).set("zlib",(()=>A)).set("transpose",(()=>m)).set("bytes",(()=>o)).set("crc32c",(()=>h)).set("vlen-utf8",(()=>y)).set("json2",(()=>u)).set("bitround",(()=>s));function b(t){let e;return{async encode(n){e||(e=await w(t));for(const t of e.array_to_array)n=await t.encode(n);let i=await e.array_to_bytes.encode(n);for(const t of e.bytes_to_bytes)i=await t.encode(i);return i},async decode(n){e||(e=await w(t));for(let t=e.bytes_to_bytes.length-1;t>=0;t--)n=await e.bytes_to_bytes[t].decode(n);let i=await e.array_to_bytes.decode(n);for(let t=e.array_to_array.length-1;t>=0;t--)i=await e.array_to_array[t].decode(i);return i}}}async function w(t){let e,n=t.codecs.map((async t=>{let e=await(E.get(t.name)?.());return(0,i.vA)(e,`Unknown codec: ${t.name}`),{Codec:e,meta:t}})),s=[],r=[];for await(let{Codec:i,meta:a}of n){let n=i.fromConfig(a.configuration,t);switch(n.kind){case"array_to_array":s.push(n);break;case"array_to_bytes":e=n;break;default:r.push(n)}}return e||((0,i.vA)("v2:object"!==t.data_type,`Cannot encode ${t.data_type} to bytes without a codec`),e=o.fromConfig({endian:"little"},t)),{array_to_array:s,array_to_bytes:e,bytes_to_bytes:r}}const v=18446744073709551615n;function I(t,e,n,s){(0,i.vA)(t.store.getRange,"Store does not support range requests");let r=t.store.getRange.bind(t.store),a=e.map(((t,e)=>t/s.chunk_shape[e])),o=b({data_type:"uint64",shape:[...a,2],codecs:s.index_codecs}),h={};return async e=>{let i,s=e.map(((t,e)=>Math.floor(t/a[e]))),c=t.resolve(n(s)).path;if(c in h)i=h[c];else{let t=4,e=16*a.reduce(((t,e)=>t*e),1),n=await r(c,{suffixLength:e+t});i=h[c]=n?await o.decode(n):null}if(null===i)return;let{data:l,shape:f,stride:u}=i,d=e.map(((t,e)=>t%f[e])).reduce(((t,e,n)=>t+e*u[n]),0),_=l[d],g=l[d+1];return _!==v||g!==v?r(c,{offset:Number(_),length:Number(g)}):void 0}}class x{store;path;constructor(t,e="/"){this.store=t,this.path=e}resolve(t){let e=new URL(`file://${this.path.endsWith("/")?this.path:`${this.path}/`}`);return new x(this.store,new URL(t,e).pathname)}}function T(t){return new x(t??new Map)}class M extends x{kind="group";#d;constructor(t,e,n){super(t,e),this.#d=n}get attrs(){return this.#d.attributes}}function S(t){const e=t.find((t=>"transpose"===t.name));return e?.configuration?.order??"C"}const N=Symbol("zarrita.context");function C(t){return t[N]}class U extends x{kind="array";#d;[N];constructor(t,e,n){super(t,e),this.#d={...n,fill_value:(0,i.HM)(n)},this[N]=function(t,e){let{configuration:n}=e.codecs.find(i.X)??{},s={encode_chunk_key:(0,i.c7)(e.chunk_key_encoding),TypedArray:(0,i.zA)(e.data_type),fill_value:e.fill_value};if(n){let r=S(n.codecs);return{...s,kind:"sharded",chunk_shape:n.chunk_shape,codec:b({data_type:e.data_type,shape:n.chunk_shape,codecs:n.codecs}),get_strides:t=>(0,i.uV)(t,r),get_chunk_bytes:I(t,e.chunk_grid.configuration.chunk_shape,s.encode_chunk_key,n)}}let r=S(e.codecs);return{...s,kind:"regular",chunk_shape:e.chunk_grid.configuration.chunk_shape,codec:b({data_type:e.data_type,shape:e.chunk_grid.configuration.chunk_shape,codecs:e.codecs}),get_strides:t=>(0,i.uV)(t,r),async get_chunk_bytes(e,n){let i=s.encode_chunk_key(e),r=t.resolve(i).path;return t.store.get(r,n)}}}(this,n)}get attrs(){return this.#d.attributes}get shape(){return this.#d.shape}get chunks(){return this[N].chunk_shape}get dtype(){return this.#d.data_type}async getChunk(t,e){let n=this[N],i=await n.get_chunk_bytes(t,e);if(!i){let t=n.chunk_shape.reduce(((t,e)=>t*e),1),e=new n.TypedArray(t);return e.fill(n.fill_value),{data:e,shape:n.chunk_shape,stride:n.get_strides(n.chunk_shape)}}return n.codec.decode(i)}is(t){return(0,i.mf)(this.dtype,t)}}},8044:(t,e,n)=>{"use strict";n.d(e,{Sz:()=>l,cx:()=>c,Ad:()=>d,AM:()=>_});var i=n(9302),s=n(2859),r=n(5976);class a{littleEndian=!1;dim_info=0;dims=[];intent_p1=0;intent_p2=0;intent_p3=0;intent_code=0;datatypeCode=0;numBitsPerVoxel=0;slice_start=0;slice_end=0;slice_code=0;pixDims=[];vox_offset=0;scl_slope=1;scl_inter=0;xyzt_units=0;cal_max=0;cal_min=0;slice_duration=0;toffset=0;description="";aux_file="";intent_name="";qform_code=0;sform_code=0;quatern_b=0;quatern_c=0;quatern_d=0;qoffset_x=0;qoffset_y=0;qoffset_z=0;affine=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];magic="0";extensionFlag=[0,0,0,0];extensions=[];extensionSize=0;extensionCode=0;static MAGIC_COOKIE=540;static MAGIC_NUMBER_LOCATION=4;static MAGIC_NUMBER=[110,43,50,0,13,10,26,10];static MAGIC_NUMBER2=[110,105,50,0,13,10,26,10];readHeader(t){var e,n,i,s,o=new DataView(t),h=r.A.getIntAt(o,0,this.littleEndian);if(h!==a.MAGIC_COOKIE&&(this.littleEndian=!0,h=r.A.getIntAt(o,0,this.littleEndian)),h!==a.MAGIC_COOKIE)throw new Error("This does not appear to be a NIFTI file!");for(this.magic=r.A.getStringAt(o,4,12),this.datatypeCode=r.A.getShortAt(o,12,this.littleEndian),this.numBitsPerVoxel=r.A.getShortAt(o,14,this.littleEndian),e=0;e<8;e+=1)s=16+8*e,this.dims[e]=r.A.getInt64At(o,s,this.littleEndian);for(this.intent_p1=r.A.getDoubleAt(o,80,this.littleEndian),this.intent_p2=r.A.getDoubleAt(o,88,this.littleEndian),this.intent_p3=r.A.getDoubleAt(o,96,this.littleEndian),e=0;e<8;e+=1)s=104+8*e,this.pixDims[e]=r.A.getDoubleAt(o,s,this.littleEndian);for(this.vox_offset=r.A.getInt64At(o,168,this.littleEndian),this.scl_slope=r.A.getDoubleAt(o,176,this.littleEndian),this.scl_inter=r.A.getDoubleAt(o,184,this.littleEndian),this.cal_max=r.A.getDoubleAt(o,192,this.littleEndian),this.cal_min=r.A.getDoubleAt(o,200,this.littleEndian),this.slice_duration=r.A.getDoubleAt(o,208,this.littleEndian),this.toffset=r.A.getDoubleAt(o,216,this.littleEndian),this.slice_start=r.A.getInt64At(o,224,this.littleEndian),this.slice_end=r.A.getInt64At(o,232,this.littleEndian),this.description=r.A.getStringAt(o,240,320),this.aux_file=r.A.getStringAt(o,320,344),this.qform_code=r.A.getIntAt(o,344,this.littleEndian),this.sform_code=r.A.getIntAt(o,348,this.littleEndian),this.quatern_b=r.A.getDoubleAt(o,352,this.littleEndian),this.quatern_c=r.A.getDoubleAt(o,360,this.littleEndian),this.quatern_d=r.A.getDoubleAt(o,368,this.littleEndian),this.qoffset_x=r.A.getDoubleAt(o,376,this.littleEndian),this.qoffset_y=r.A.getDoubleAt(o,384,this.littleEndian),this.qoffset_z=r.A.getDoubleAt(o,392,this.littleEndian),n=0;n<3;n+=1)for(i=0;i<4;i+=1)s=400+8*(4*n+i),this.affine[n][i]=r.A.getDoubleAt(o,s,this.littleEndian);this.affine[3][0]=0,this.affine[3][1]=0,this.affine[3][2]=0,this.affine[3][3]=1,this.slice_code=r.A.getIntAt(o,496,this.littleEndian),this.xyzt_units=r.A.getIntAt(o,500,this.littleEndian),this.intent_code=r.A.getIntAt(o,504,this.littleEndian),this.intent_name=r.A.getStringAt(o,508,524),this.dim_info=r.A.getByteAt(o,524),o.byteLength>a.MAGIC_COOKIE&&(this.extensionFlag[0]=r.A.getByteAt(o,540),this.extensionFlag[1]=r.A.getByteAt(o,541),this.extensionFlag[2]=r.A.getByteAt(o,542),this.extensionFlag[3]=r.A.getByteAt(o,543),this.extensionFlag[0]&&(this.extensions=r.A.getExtensionsAt(o,this.getExtensionLocation(),this.littleEndian,this.vox_offset),this.extensionSize=this.extensions[0].esize,this.extensionCode=this.extensions[0].ecode))}toFormattedString(){var t=r.A.formatNumber,e="";return e+="Datatype = "+ +this.datatypeCode+" ("+this.getDatatypeCodeString(this.datatypeCode)+")\n",e+="Bits Per Voxel =  = "+this.numBitsPerVoxel+"\n",e+="Image Dimensions (1-8): "+this.dims[0]+", "+this.dims[1]+", "+this.dims[2]+", "+this.dims[3]+", "+this.dims[4]+", "+this.dims[5]+", "+this.dims[6]+", "+this.dims[7]+"\n",e+="Intent Parameters (1-3): "+this.intent_p1+", "+this.intent_p2+", "+this.intent_p3+"\n",e+="Voxel Dimensions (1-8): "+t(this.pixDims[0])+", "+t(this.pixDims[1])+", "+t(this.pixDims[2])+", "+t(this.pixDims[3])+", "+t(this.pixDims[4])+", "+t(this.pixDims[5])+", "+t(this.pixDims[6])+", "+t(this.pixDims[7])+"\n",e+="Image Offset = "+this.vox_offset+"\n",e+="Data Scale:  Slope = "+t(this.scl_slope)+"  Intercept = "+t(this.scl_inter)+"\n",e+="Display Range:  Max = "+t(this.cal_max)+"  Min = "+t(this.cal_min)+"\n",e+="Slice Duration = "+this.slice_duration+"\n",e+="Time Axis Shift = "+this.toffset+"\n",e+="Slice Start = "+this.slice_start+"\n",e+="Slice End = "+this.slice_end+"\n",e+='Description: "'+this.description+'"\n',e+='Auxiliary File: "'+this.aux_file+'"\n',e+="Q-Form Code = "+this.qform_code+" ("+this.getTransformCodeString(this.qform_code)+")\n",e+="S-Form Code = "+this.sform_code+" ("+this.getTransformCodeString(this.sform_code)+")\n",e+="Quaternion Parameters:  b = "+t(this.quatern_b)+"  c = "+t(this.quatern_c)+"  d = "+t(this.quatern_d)+"\n",e+="Quaternion Offsets:  x = "+this.qoffset_x+"  y = "+this.qoffset_y+"  z = "+this.qoffset_z+"\n",e+="S-Form Parameters X: "+t(this.affine[0][0])+", "+t(this.affine[0][1])+", "+t(this.affine[0][2])+", "+t(this.affine[0][3])+"\n",e+="S-Form Parameters Y: "+t(this.affine[1][0])+", "+t(this.affine[1][1])+", "+t(this.affine[1][2])+", "+t(this.affine[1][3])+"\n",e+="S-Form Parameters Z: "+t(this.affine[2][0])+", "+t(this.affine[2][1])+", "+t(this.affine[2][2])+", "+t(this.affine[2][3])+"\n",e+="Slice Code = "+this.slice_code+"\n",e+="Units Code = "+this.xyzt_units+" ("+this.getUnitsCodeString(s.a.SPATIAL_UNITS_MASK&this.xyzt_units)+", "+this.getUnitsCodeString(s.a.TEMPORAL_UNITS_MASK&this.xyzt_units)+")\n",e+="Intent Code = "+this.intent_code+"\n",e+='Intent Name: "'+this.intent_name+'"\n',e+="Dim Info = "+this.dim_info+"\n"}getExtensionLocation=function(){return a.MAGIC_COOKIE+4};getExtensionSize=s.a.prototype.getExtensionSize;getExtensionCode=s.a.prototype.getExtensionCode;addExtension=s.a.prototype.addExtension;removeExtension=s.a.prototype.removeExtension;getDatatypeCodeString=s.a.prototype.getDatatypeCodeString;getTransformCodeString=s.a.prototype.getTransformCodeString;getUnitsCodeString=s.a.prototype.getUnitsCodeString;getQformMat=s.a.prototype.getQformMat;convertNiftiQFormToNiftiSForm=s.a.prototype.convertNiftiQFormToNiftiSForm;convertNiftiSFormToNEMA=s.a.prototype.convertNiftiSFormToNEMA;nifti_mat33_mul=s.a.prototype.nifti_mat33_mul;nifti_mat33_determ=s.a.prototype.nifti_mat33_determ;toArrayBuffer(t=!1){let e=544;if(t)for(let r of this.extensions)e+=r.esize;let n=new Uint8Array(e),i=new DataView(n.buffer);i.setInt32(0,540,this.littleEndian),n.set((new TextEncoder).encode(this.magic),4),i.setInt16(12,this.datatypeCode,this.littleEndian),i.setInt16(14,this.numBitsPerVoxel,this.littleEndian);for(let r=0;r<8;r++)i.setBigInt64(16+8*r,BigInt(this.dims[r]),this.littleEndian);i.setFloat64(80,this.intent_p1,this.littleEndian),i.setFloat64(88,this.intent_p2,this.littleEndian),i.setFloat64(96,this.intent_p3,this.littleEndian);for(let r=0;r<8;r++)i.setFloat64(104+8*r,this.pixDims[r],this.littleEndian);i.setBigInt64(168,BigInt(this.vox_offset),this.littleEndian),i.setFloat64(176,this.scl_slope,this.littleEndian),i.setFloat64(184,this.scl_inter,this.littleEndian),i.setFloat64(192,this.cal_max,this.littleEndian),i.setFloat64(200,this.cal_min,this.littleEndian),i.setFloat64(208,this.slice_duration,this.littleEndian),i.setFloat64(216,this.toffset,this.littleEndian),i.setBigInt64(224,BigInt(this.slice_start),this.littleEndian),i.setBigInt64(232,BigInt(this.slice_end),this.littleEndian),n.set((new TextEncoder).encode(this.description),240),n.set((new TextEncoder).encode(this.aux_file),320),i.setInt32(344,this.qform_code,this.littleEndian),i.setInt32(348,this.sform_code,this.littleEndian),i.setFloat64(352,this.quatern_b,this.littleEndian),i.setFloat64(360,this.quatern_c,this.littleEndian),i.setFloat64(368,this.quatern_d,this.littleEndian),i.setFloat64(376,this.qoffset_x,this.littleEndian),i.setFloat64(384,this.qoffset_y,this.littleEndian),i.setFloat64(392,this.qoffset_z,this.littleEndian);const s=this.affine.flat();for(let r=0;r<12;r++)i.setFloat64(400+8*r,s[r],this.littleEndian);if(i.setInt32(496,this.slice_code,this.littleEndian),i.setInt32(500,this.xyzt_units,this.littleEndian),i.setInt32(504,this.intent_code,this.littleEndian),n.set((new TextEncoder).encode(this.intent_name),508),i.setUint8(524,this.dim_info),t){n.set(Uint8Array.from([1,0,0,0]),540);let t=this.getExtensionLocation();for(const e of this.extensions)i.setInt32(t,e.esize,e.littleEndian),i.setInt32(t+4,e.ecode,e.littleEndian),n.set(new Uint8Array(e.edata),t+8),t+=e.esize}else n.set(new Uint8Array(4).fill(0),540);return n.buffer}}function o(t,e=!1){var n,i,r,a;return!(t.byteLength<s.a.STANDARD_HEADER_SIZE)&&((n=new DataView(t))&&(i=n.getUint8(s.a.MAGIC_NUMBER_LOCATION)),r=n.getUint8(s.a.MAGIC_NUMBER_LOCATION+1),a=n.getUint8(s.a.MAGIC_NUMBER_LOCATION+2),!(!e||i!==s.a.MAGIC_NUMBER2[0]||r!==s.a.MAGIC_NUMBER2[1]||a!==s.a.MAGIC_NUMBER2[2])||!(i!==s.a.MAGIC_NUMBER[0]||r!==s.a.MAGIC_NUMBER[1]||a!==s.a.MAGIC_NUMBER[2]))}function h(t,e=!1){var n,i,r,o;return!(t.byteLength<s.a.STANDARD_HEADER_SIZE)&&(i=(n=new DataView(t)).getUint8(a.MAGIC_NUMBER_LOCATION),r=n.getUint8(a.MAGIC_NUMBER_LOCATION+1),o=n.getUint8(a.MAGIC_NUMBER_LOCATION+2),!(!e||i!==a.MAGIC_NUMBER2[0]||r!==a.MAGIC_NUMBER2[1]||o!==a.MAGIC_NUMBER2[2])||!(i!==a.MAGIC_NUMBER[0]||r!==a.MAGIC_NUMBER[1]||o!==a.MAGIC_NUMBER[2]))}function c(t){var e,n,i;if(t){if(n=(e=new DataView(t)).getUint8(0),i=e.getUint8(1),n===r.A.GUNZIP_MAGIC_COOKIE1)return!0;if(i===r.A.GUNZIP_MAGIC_COOKIE2)return!0}return!1}async function l(t){const e=new Uint8Array(t),n=31===e[0]&&139===e[1]&&8===e[2]?"gzip":120!==e[0]||1!==e[1]&&94!==e[1]&&156!==e[1]&&218!==e[1]?"deflate-raw":"deflate",i=new DecompressionStream(n),s=i.writable.getWriter();s.write(e).catch(console.error);const r=s.close().catch(console.error),a=new Response(i.readable),o=await a.arrayBuffer();return await r,o}async function f(t,e=1/0){const n=new Uint8Array(t),i=(t=>31===t[0]&&139===t[1]&&8===t[2]?"gzip":120===t[0]&&[1,94,156,218].includes(t[1])?"deflate":"deflate-raw")(n),s=new DecompressionStream(i),r=new TransformStream({transform(t,e){e.enqueue(t)},flush(t){t.terminate()}}),{readable:a,writable:o}=s,h=o.getWriter(),c=a.pipeThrough(r).getReader();h.write(n).catch((t=>{t instanceof Error&&"AbortError"===t.name||console.error("Error during write:",t)}));const l=[];let f=0;try{for(;f<e;){const{done:t,value:n}=await c.read();if(t)break;const i=e-f,s=n.subarray(0,Math.min(n.length,i));if(l.push(s),f+=s.length,f>=e){await Promise.all([c.cancel().catch((()=>{})),h.abort().catch((()=>{}))]);break}}}catch(u){u instanceof Error&&"AbortError"===u.name||console.error("Error during decompression:",u)}finally{await Promise.allSettled([c.cancel().catch((()=>{})),h.close().catch((()=>{}))])}return 1===l.length?l[0].buffer:l.reduce(((t,e)=>{const n=new Uint8Array(t.byteLength+e.byteLength);return n.set(new Uint8Array(t),0),n.set(e,t.byteLength),n.buffer}),new ArrayBuffer(0))}function u(t,e=!1){let n=null;if(c(t)&&(t=function(t){return(0,i.Rq)(new Uint8Array(t)).buffer}(t)),o(t,e)?n=new s.a:h(t,e)&&(n=new a),!n)throw new Error("That file does not appear to be NIFTI!");return n.readHeader(t),n}async function d(t,e=!1){if(!c(t))return u(t,e);let n=null,i=await f(t,540),o=!0,h=!0;var l=new DataView(i);const d=l.getInt32(0,!0),_=l.getInt32(0,!1);if(348===d);else if(348===_)o=!1;else if(540===d)h=!1;else{if(540!==_)throw new Error("That file does not appear to be NIFTI!");h=!1,o=!1}let g=Math.round(l.getFloat32(108,o));return a&&(g=r.A.getUint64At(l,168,o)),g>i.byteLength&&(i=await f(t,g)),n=h?new s.a:new a,n.readHeader(i),n}function _(t,e){var n=t.vox_offset,i=1,s=1;t.dims[4]&&(i=t.dims[4]),t.dims[5]&&(s=t.dims[5]);var r=t.dims[1]*t.dims[2]*t.dims[3]*i*s*(t.numBitsPerVoxel/8);return e.slice(n,n+r)}},8553:(t,e,n)=>{"use strict";n.d(e,{Ei:()=>u,Wm:()=>h,ff:()=>f,lC:()=>c,qv:()=>a,rK:()=>l,sO:()=>r,tV:()=>i,uT:()=>s,vH:()=>o});const i=-1,s=0,r=1,a=2,o=3,h=4,c=5,l=6,f=7,u=8},9095:(t,e,n)=>{"use strict";n.d(e,{$0:()=>p,B8:()=>l,C:()=>a,D_:()=>h,Ny:()=>y,Qr:()=>g,Tl:()=>u,eL:()=>_,fA:()=>o,hs:()=>d,lK:()=>A,lw:()=>f,mg:()=>c,o8:()=>r,v3:()=>m,vt:()=>s});var i=n(3172);function s(){var t=new i.tb(16);return i.tb!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function r(t){var e=new i.tb(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function a(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function o(t,e,n,s,r,a,o,h,c,l,f,u,d,_,g,p){var m=new i.tb(16);return m[0]=t,m[1]=e,m[2]=n,m[3]=s,m[4]=r,m[5]=a,m[6]=o,m[7]=h,m[8]=c,m[9]=l,m[10]=f,m[11]=u,m[12]=d,m[13]=_,m[14]=g,m[15]=p,m}function h(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function c(t,e){if(t===e){var n=e[1],i=e[2],s=e[3],r=e[6],a=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=r,t[11]=e[14],t[12]=s,t[13]=a,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function l(t,e){var n=e[0],i=e[1],s=e[2],r=e[3],a=e[4],o=e[5],h=e[6],c=e[7],l=e[8],f=e[9],u=e[10],d=e[11],_=e[12],g=e[13],p=e[14],m=e[15],y=n*o-i*a,A=n*h-s*a,E=n*c-r*a,b=i*h-s*o,w=i*c-r*o,v=s*c-r*h,I=l*g-f*_,x=l*p-u*_,T=l*m-d*_,M=f*p-u*g,S=f*m-d*g,N=u*m-d*p,C=y*N-A*S+E*M+b*T-w*x+v*I;return C?(C=1/C,t[0]=(o*N-h*S+c*M)*C,t[1]=(s*S-i*N-r*M)*C,t[2]=(g*v-p*w+m*b)*C,t[3]=(u*w-f*v-d*b)*C,t[4]=(h*T-a*N-c*x)*C,t[5]=(n*N-s*T+r*x)*C,t[6]=(p*E-_*v-m*A)*C,t[7]=(l*v-u*E+d*A)*C,t[8]=(a*S-o*T+c*I)*C,t[9]=(i*T-n*S-r*I)*C,t[10]=(_*w-g*E+m*y)*C,t[11]=(f*E-l*w-d*y)*C,t[12]=(o*x-a*M-h*I)*C,t[13]=(n*M-i*x+s*I)*C,t[14]=(g*A-_*b-p*y)*C,t[15]=(l*b-f*A+u*y)*C,t):null}function f(t,e,n){var i=e[0],s=e[1],r=e[2],a=e[3],o=e[4],h=e[5],c=e[6],l=e[7],f=e[8],u=e[9],d=e[10],_=e[11],g=e[12],p=e[13],m=e[14],y=e[15],A=n[0],E=n[1],b=n[2],w=n[3];return t[0]=A*i+E*o+b*f+w*g,t[1]=A*s+E*h+b*u+w*p,t[2]=A*r+E*c+b*d+w*m,t[3]=A*a+E*l+b*_+w*y,A=n[4],E=n[5],b=n[6],w=n[7],t[4]=A*i+E*o+b*f+w*g,t[5]=A*s+E*h+b*u+w*p,t[6]=A*r+E*c+b*d+w*m,t[7]=A*a+E*l+b*_+w*y,A=n[8],E=n[9],b=n[10],w=n[11],t[8]=A*i+E*o+b*f+w*g,t[9]=A*s+E*h+b*u+w*p,t[10]=A*r+E*c+b*d+w*m,t[11]=A*a+E*l+b*_+w*y,A=n[12],E=n[13],b=n[14],w=n[15],t[12]=A*i+E*o+b*f+w*g,t[13]=A*s+E*h+b*u+w*p,t[14]=A*r+E*c+b*d+w*m,t[15]=A*a+E*l+b*_+w*y,t}function u(t,e,n){var i,s,r,a,o,h,c,l,f,u,d,_,g=n[0],p=n[1],m=n[2];return e===t?(t[12]=e[0]*g+e[4]*p+e[8]*m+e[12],t[13]=e[1]*g+e[5]*p+e[9]*m+e[13],t[14]=e[2]*g+e[6]*p+e[10]*m+e[14],t[15]=e[3]*g+e[7]*p+e[11]*m+e[15]):(i=e[0],s=e[1],r=e[2],a=e[3],o=e[4],h=e[5],c=e[6],l=e[7],f=e[8],u=e[9],d=e[10],_=e[11],t[0]=i,t[1]=s,t[2]=r,t[3]=a,t[4]=o,t[5]=h,t[6]=c,t[7]=l,t[8]=f,t[9]=u,t[10]=d,t[11]=_,t[12]=i*g+o*p+f*m+e[12],t[13]=s*g+h*p+u*m+e[13],t[14]=r*g+c*p+d*m+e[14],t[15]=a*g+l*p+_*m+e[15]),t}function d(t,e,n){var i=n[0],s=n[1],r=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function _(t,e,n){var i=Math.sin(n),s=Math.cos(n),r=e[4],a=e[5],o=e[6],h=e[7],c=e[8],l=e[9],f=e[10],u=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=r*s+c*i,t[5]=a*s+l*i,t[6]=o*s+f*i,t[7]=h*s+u*i,t[8]=c*s-r*i,t[9]=l*s-a*i,t[10]=f*s-o*i,t[11]=u*s-h*i,t}function g(t,e,n){var i=Math.sin(n),s=Math.cos(n),r=e[0],a=e[1],o=e[2],h=e[3],c=e[4],l=e[5],f=e[6],u=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*s+c*i,t[1]=a*s+l*i,t[2]=o*s+f*i,t[3]=h*s+u*i,t[4]=c*s-r*i,t[5]=l*s-a*i,t[6]=f*s-o*i,t[7]=u*s-h*i,t}function p(t,e,n){var s,r,a,o=n[0],h=n[1],c=n[2],l=Math.hypot(o,h,c);return l<i.p8?null:(o*=l=1/l,h*=l,c*=l,s=Math.sin(e),a=1-(r=Math.cos(e)),t[0]=o*o*a+r,t[1]=h*o*a+c*s,t[2]=c*o*a-h*s,t[3]=0,t[4]=o*h*a-c*s,t[5]=h*h*a+r,t[6]=c*h*a+o*s,t[7]=0,t[8]=o*c*a+h*s,t[9]=h*c*a-o*s,t[10]=c*c*a+r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}var m=function(t,e,n,i,s,r,a){var o=1/(e-n),h=1/(i-s),c=1/(r-a);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*o,t[13]=(s+i)*h,t[14]=(a+r)*c,t[15]=1,t};function y(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}var A=f},9247:(t,e,n)=>{"use strict";function i(t,e,n,i={}){return void 0!==e&&void 0!==n&&(i={...i,headers:{...i.headers,Range:`bytes=${e}-${e+n-1}`}}),fetch(t,i)}function s(t,e){const n="string"==typeof t?new URL(t):t;n.pathname.endsWith("/")||(n.pathname+="/");const i=new URL(e.slice(1),n);return i.search=n.search,i}async function r(t){if(404!==t.status){if(200===t.status||206===t.status)return new Uint8Array(await t.arrayBuffer());throw new Error(`Unexpected response status ${t.status} ${t.statusText}`)}}n.d(e,{A:()=>a});const a=class{url;#_;#g;constructor(t,e={}){this.url=t,this.#_=e.overrides??{},this.#g=e.useSuffixRequest??!1}#p(t){return e=this.#_,n=t,{...e,...n,headers:{...e.headers,...n.headers}};var e,n}async get(t,e={}){let n=s(this.url,t).href;return r(await fetch(n,this.#p(e)))}async getRange(t,e,n={}){let a,o=s(this.url,t),h=this.#p(n);return a="suffixLength"in e?await async function(t,e,n,s){if(s)return fetch(t,{...n,headers:{...n.headers,Range:`bytes=-${e}`}});let r=await fetch(t,{...n,method:"HEAD"});if(!r.ok)return r;let a=r.headers.get("Content-Length"),o=Number(a);return i(t,o-e,o,n)}(o,e.suffixLength,h,this.#g):await i(o,e.offset,e.length,h),r(a)}}},9302:(t,e,n)=>{"use strict";n.d(e,{Rq:()=>z,as:()=>B});var i=Uint8Array,s=Uint16Array,r=Int32Array,a=new i([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),o=new i([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),h=new i([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),c=function(t,e){for(var n=new s(31),i=0;i<31;++i)n[i]=e+=1<<t[i-1];var a=new r(n[30]);for(i=1;i<30;++i)for(var o=n[i];o<n[i+1];++o)a[o]=o-n[i]<<5|i;return{b:n,r:a}},l=c(a,2),f=l.b,u=l.r;f[28]=258,u[258]=28;for(var d=c(o,0),_=d.b,g=(d.r,new s(32768)),p=0;p<32768;++p){var m=(43690&p)>>1|(21845&p)<<1;m=(61680&(m=(52428&m)>>2|(13107&m)<<2))>>4|(3855&m)<<4,g[p]=((65280&m)>>8|(255&m)<<8)>>1}var y=function(t,e,n){for(var i=t.length,r=0,a=new s(e);r<i;++r)t[r]&&++a[t[r]-1];var o,h=new s(e);for(r=1;r<e;++r)h[r]=h[r-1]+a[r-1]<<1;if(n){o=new s(1<<e);var c=15-e;for(r=0;r<i;++r)if(t[r])for(var l=r<<4|t[r],f=e-t[r],u=h[t[r]-1]++<<f,d=u|(1<<f)-1;u<=d;++u)o[g[u]>>c]=l}else for(o=new s(i),r=0;r<i;++r)t[r]&&(o[r]=g[h[t[r]-1]++]>>15-t[r]);return o},A=new i(288);for(p=0;p<144;++p)A[p]=8;for(p=144;p<256;++p)A[p]=9;for(p=256;p<280;++p)A[p]=7;for(p=280;p<288;++p)A[p]=8;var E=new i(32);for(p=0;p<32;++p)E[p]=5;var b=y(A,9,1),w=y(E,5,1),v=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},I=function(t,e,n){var i=e/8|0;return(t[i]|t[i+1]<<8)>>(7&e)&n},x=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(7&e)},T=function(t){return(t+7)/8|0},M=function(t,e,n){return(null==e||e<0)&&(e=0),(null==n||n>t.length)&&(n=t.length),new i(t.subarray(e,n))},S=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],N=function(t,e,n){var i=new Error(e||S[t]);if(i.code=t,Error.captureStackTrace&&Error.captureStackTrace(i,N),!n)throw i;return i},C=function(t,e,n,s){var r=t.length,c=s?s.length:0;if(!r||e.f&&!e.l)return n||new i(0);var l=!n,u=l||2!=e.i,d=e.i;l&&(n=new i(3*r));var g=function(t){var e=n.length;if(t>e){var s=new i(Math.max(2*e,t));s.set(n),n=s}},p=e.f||0,m=e.p||0,A=e.b||0,E=e.l,S=e.d,C=e.m,U=e.n,k=8*r;do{if(!E){p=I(t,m,1);var F=I(t,m+1,3);if(m+=3,!F){var O=t[(K=T(m)+4)-4]|t[K-3]<<8,q=K+O;if(q>r){d&&N(0);break}u&&g(A+O),n.set(t.subarray(K,q),A),e.b=A+=O,e.p=m=8*q,e.f=p;continue}if(1==F)E=b,S=w,C=9,U=5;else if(2==F){var D=I(t,m,31)+257,B=I(t,m+10,15)+4,R=D+I(t,m+5,31)+1;m+=14;for(var P=new i(R),z=new i(19),L=0;L<B;++L)z[h[L]]=I(t,m+3*L,7);m+=3*B;var Y=v(z),G=(1<<Y)-1,V=y(z,Y,1);for(L=0;L<R;){var K,$=V[I(t,m,G)];if(m+=15&$,(K=$>>4)<16)P[L++]=K;else{var Z=0,X=0;for(16==K?(X=3+I(t,m,3),m+=2,Z=P[L-1]):17==K?(X=3+I(t,m,7),m+=3):18==K&&(X=11+I(t,m,127),m+=7);X--;)P[L++]=Z}}var H=P.subarray(0,D),j=P.subarray(D);C=v(H),U=v(j),E=y(H,C,1),S=y(j,U,1)}else N(1);if(m>k){d&&N(0);break}}u&&g(A+131072);for(var J=(1<<C)-1,Q=(1<<U)-1,W=m;;W=m){var tt=(Z=E[x(t,m)&J])>>4;if((m+=15&Z)>k){d&&N(0);break}if(Z||N(2),tt<256)n[A++]=tt;else{if(256==tt){W=m,E=null;break}var et=tt-254;if(tt>264){var nt=a[L=tt-257];et=I(t,m,(1<<nt)-1)+f[L],m+=nt}var it=S[x(t,m)&Q],st=it>>4;it||N(3),m+=15&it;j=_[st];if(st>3){nt=o[st];j+=x(t,m)&(1<<nt)-1,m+=nt}if(m>k){d&&N(0);break}u&&g(A+131072);var rt=A+et;if(A<j){var at=c-j,ot=Math.min(j,rt);for(at+A<0&&N(3);A<ot;++A)n[A]=s[at+A]}for(;A<rt;++A)n[A]=n[A-j]}}e.l=E,e.p=W,e.b=A,e.f=p,E&&(p=1,e.m=C,e.d=S,e.n=U)}while(!p);return A!=n.length&&l?M(n,0,A):n.subarray(0,A)},U=new i(0),k=function(t){31==t[0]&&139==t[1]&&8==t[2]||N(6,"invalid gzip data");var e=t[3],n=10;4&e&&(n+=2+(t[10]|t[11]<<8));for(var i=(e>>3&1)+(e>>4&1);i>0;i-=!t[n++]);return n+(2&e)},F=function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0},O=function(t,e){return(8!=(15&t[0])||t[0]>>4>7||(t[0]<<8|t[1])%31)&&N(6,"invalid zlib data"),(t[1]>>5&1)==+!e&&N(6,"invalid zlib data: "+(32&t[1]?"need":"unexpected")+" dictionary"),2+(t[1]>>3&4)};var q=function(){function t(t,e){"function"==typeof t&&(e=t,t={}),this.ondata=e;var n=t&&t.dictionary&&t.dictionary.subarray(-32768);this.s={i:0,b:n?n.length:0},this.o=new i(32768),this.p=new i(0),n&&this.o.set(n)}return t.prototype.e=function(t){if(this.ondata||N(5),this.d&&N(4),this.p.length){if(t.length){var e=new i(this.p.length+t.length);e.set(this.p),e.set(t,this.p.length),this.p=e}}else this.p=t},t.prototype.c=function(t){this.s.i=+(this.d=t||!1);var e=this.s.b,n=C(this.p,this.s,this.o);this.ondata(M(n,e,this.s.b),this.d),this.o=M(n,this.s.b-32768),this.s.b=this.o.length,this.p=M(this.p,this.s.p/8|0),this.s.p&=7},t.prototype.push=function(t,e){this.e(t),this.c(e)},t}();function D(t,e){return C(t,{i:2},e&&e.out,e&&e.dictionary)}var B=function(){function t(t,e){this.v=1,this.r=0,q.call(this,t,e)}return t.prototype.push=function(t,e){if(q.prototype.e.call(this,t),this.r+=t.length,this.v){var n=this.p.subarray(this.v-1),s=n.length>3?k(n):4;if(s>n.length){if(!e)return}else this.v>1&&this.onmember&&this.onmember(this.r-n.length);this.p=n.subarray(s),this.v=0}q.prototype.c.call(this,e),!this.s.f||this.s.l||e||(this.v=T(this.s.p)+9,this.s={i:0},this.o=new i(0),this.push(new i(0),e))},t}();function R(t,e){var n=k(t);return n+8>t.length&&N(6,"invalid gzip data"),C(t.subarray(n,-8),{i:2},e&&e.out||new i(F(t)),e&&e.dictionary)}function P(t,e){return C(t.subarray(O(t,e&&e.dictionary),-4),{i:2},e&&e.out,e&&e.dictionary)}function z(t,e){return 31==t[0]&&139==t[1]&&8==t[2]?R(t,e):8!=(15&t[0])||t[0]>>4>7||(t[0]<<8|t[1])%31?D(t,e):P(t,e)}var L="undefined"!=typeof TextDecoder&&new TextDecoder;try{L.decode(U,{stream:!0})}catch(Y){}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout},9659:(t,e,n)=>{"use strict";n.d(e,{v4:()=>a});for(var i,s=256,r=[];s--;)r[s]=(s+256).toString(16).substring(1);function a(){var t,e=0,n="";if(!i||s+16>256){for(i=Array(e=256);e--;)i[e]=256*Math.random()|0;e=s=0}for(;e<16;e++)t=i[s+e],n+=6==e?r[15&t|64]:8==e?r[63&t|128]:r[t],1&e&&e>1&&e<11&&(n+="-");return s++,n}}}]);